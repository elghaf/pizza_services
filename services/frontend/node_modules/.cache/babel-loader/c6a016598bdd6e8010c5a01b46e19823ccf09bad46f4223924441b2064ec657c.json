{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ayoub\\\\OneDrive\\\\Desktop\\\\eagleAI\\\\pizza_store_detection\\\\services\\\\frontend\\\\src\\\\components\\\\ROIZoneManager.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ROIZoneManager = ({\n  currentFrame,\n  onZonesUpdate,\n  existingZones = [],\n  isEnabled = true,\n  frameWidth = 640,\n  frameHeight = 480\n}) => {\n  _s();\n  const canvasRef = useRef(null);\n  const [zones, setZones] = useState(existingZones);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [currentZone, setCurrentZone] = useState(null);\n  const [selectedZoneType, setSelectedZoneType] = useState('sauce_area');\n  const [editingZone, setEditingZone] = useState(null);\n  const [showZones, setShowZones] = useState(true);\n\n  // New polygon drawing states\n  const [drawingMode, setDrawingMode] = useState('rectangle'); // 'rectangle' or 'polygon'\n  const [polygonPoints, setPolygonPoints] = useState([]);\n  const [previewPoint, setPreviewPoint] = useState(null);\n\n  // Zone types with professional configuration\n  const zoneTypes = {\n    sauce_area: {\n      name: 'Sauce Area',\n      color: '#FF6B35',\n      fillColor: 'rgba(255, 107, 53, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ…',\n      description: 'Sauce dispensing and handling area',\n      preferredShape: 'polygon' // Sauce areas work better with polygons\n    },\n    cheese_area: {\n      name: 'Cheese Area',\n      color: '#FFD23F',\n      fillColor: 'rgba(255, 210, 63, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ§€',\n      description: 'Cheese container and handling area',\n      preferredShape: 'rectangle' // Cheese containers are usually rectangular\n    },\n    meat_area: {\n      name: 'Meat/Protein Area',\n      color: '#FF4757',\n      fillColor: 'rgba(255, 71, 87, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ¥“',\n      description: 'Meat and protein ingredient area'\n    },\n    vegetable_area: {\n      name: 'Vegetable Area',\n      color: '#2ED573',\n      fillColor: 'rgba(46, 213, 115, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ¥¬',\n      description: 'Vegetable and fresh ingredient area'\n    },\n    prep_surface: {\n      name: 'Prep Surface',\n      color: '#5352ED',\n      fillColor: 'rgba(83, 82, 237, 0.2)',\n      requiresScooper: false,\n      icon: 'ðŸ•',\n      description: 'Pizza preparation surface (no scooper required)'\n    },\n    cleaning_area: {\n      name: 'Cleaning Area',\n      color: '#00D2D3',\n      fillColor: 'rgba(0, 210, 211, 0.2)',\n      requiresScooper: false,\n      icon: 'ðŸ§½',\n      description: 'Cleaning and sanitization area'\n    }\n  };\n  useEffect(() => {\n    if (onZonesUpdate) {\n      onZonesUpdate(zones);\n    }\n  }, [zones, onZonesUpdate]);\n  useEffect(() => {\n    drawZones();\n  }, [zones, currentFrame, showZones, frameWidth, frameHeight]);\n  const getCanvasCoordinates = event => {\n    const canvas = canvasRef.current;\n    if (!canvas) return {\n      x: 0,\n      y: 0\n    };\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    // Get display coordinates\n    const displayCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n\n    // Convert to natural frame coordinates for storage\n    const backgroundImg = document.getElementById('roi-background-image');\n    let naturalCoords = displayCoords;\n    if (backgroundImg) {\n      const naturalWidth = backgroundImg.naturalWidth || frameWidth;\n      const naturalHeight = backgroundImg.naturalHeight || frameHeight;\n      const displayWidth = canvas.width;\n      const displayHeight = canvas.height;\n      const naturalScaleX = naturalWidth / displayWidth;\n      const naturalScaleY = naturalHeight / displayHeight;\n      naturalCoords = {\n        x: displayCoords.x * naturalScaleX,\n        y: displayCoords.y * naturalScaleY\n      };\n    }\n    console.log('ðŸ–±ï¸ Mouse coordinates:', {\n      client: {\n        x: event.clientX,\n        y: event.clientY\n      },\n      display: displayCoords,\n      natural: naturalCoords,\n      canvas: {\n        width: canvas.width,\n        height: canvas.height\n      },\n      frame: {\n        width: frameWidth,\n        height: frameHeight\n      }\n    });\n    return naturalCoords;\n  };\n  const handleMouseDown = event => {\n    if (!isEnabled) {\n      console.log('ðŸš« Drawing disabled');\n      return;\n    }\n    console.log('ðŸ–±ï¸ Mouse down event triggered');\n    event.preventDefault();\n\n    // Get both natural and display coordinates\n    const naturalCoords = getCanvasCoordinates(event); // This returns natural coordinates\n\n    // Also get display coordinates for drawing preview\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n    const displayCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n\n    // Check if clicking on existing zone for editing (use natural coordinates)\n    const clickedZone = findZoneAtPoint(naturalCoords.x, naturalCoords.y);\n    if (clickedZone) {\n      console.log('âœï¸ Editing existing zone:', clickedZone.name);\n      setEditingZone(clickedZone);\n      return;\n    }\n    if (drawingMode === 'polygon') {\n      handlePolygonClick(displayCoords, naturalCoords);\n    } else {\n      handleRectangleStart(displayCoords, naturalCoords);\n    }\n  };\n  const handlePolygonClick = (displayCoords, naturalCoords) => {\n    // Check if clicking near the first point to close polygon\n    if (polygonPoints.length > 2) {\n      const firstPoint = polygonPoints[0];\n      const distance = Math.sqrt(Math.pow(displayCoords.x - firstPoint.x, 2) + Math.pow(displayCoords.y - firstPoint.y, 2));\n      if (distance < 15) {\n        // Close polygon\n        completePolygon();\n        return;\n      }\n    }\n\n    // Add new point to polygon\n    const newPoints = [...polygonPoints, displayCoords];\n    setPolygonPoints(newPoints);\n    setIsDrawing(true);\n    toast.info(`Point ${newPoints.length} added. ${newPoints.length > 2 ? 'Click near first point to close.' : ''}`);\n  };\n  const handleRectangleStart = (displayCoords, naturalCoords) => {\n    // Start drawing new rectangle zone with display coordinates for preview\n    console.log('ðŸ“¦ Starting rectangle zone drawing:', {\n      display: displayCoords,\n      natural: naturalCoords\n    });\n    setIsDrawing(true);\n    setCurrentZone({\n      id: `zone_${Date.now()}`,\n      type: selectedZoneType,\n      points: [displayCoords],\n      // Use display coordinates for preview\n      isComplete: false,\n      isPreview: true,\n      shape: 'rectangle'\n    });\n  };\n  const completePolygon = () => {\n    if (polygonPoints.length < 3) {\n      toast.error('Polygon must have at least 3 points');\n      return;\n    }\n\n    // Convert display coordinates to natural coordinates for storage\n    const naturalPoints = polygonPoints.map(point => {\n      const canvas = canvasRef.current;\n      const rect = canvas.getBoundingClientRect();\n      const scaleX = frameWidth / canvas.width;\n      const scaleY = frameHeight / canvas.height;\n      return {\n        x: point.x * scaleX,\n        y: point.y * scaleY\n      };\n    });\n    const newZone = {\n      id: `zone_${Date.now()}`,\n      type: selectedZoneType,\n      shape: 'polygon',\n      points: naturalPoints,\n      isComplete: true,\n      isPreview: false,\n      name: `${zoneTypes[selectedZoneType].name} ${zones.length + 1}`,\n      requiresScooper: zoneTypes[selectedZoneType].requiresScooper\n    };\n    const newZones = [...zones, newZone];\n    setZones(newZones);\n    onZonesUpdate(newZones);\n\n    // Reset polygon drawing state\n    setPolygonPoints([]);\n    setIsDrawing(false);\n    setPreviewPoint(null);\n    toast.success(`${zoneTypes[selectedZoneType].name} polygon zone created!`);\n    drawZones(); // Redraw with the new zone\n  };\n  const handleMouseMove = event => {\n    var _zoneTypes$selectedZo;\n    if (!isEnabled) return;\n    event.preventDefault();\n\n    // Get display coordinates for preview\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n    const displayCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n    if (drawingMode === 'polygon' && isDrawing && polygonPoints.length > 0) {\n      // Update preview point for polygon\n      setPreviewPoint(displayCoords);\n    } else if (drawingMode === 'rectangle' && isDrawing && currentZone) {\n      // Update current zone with display coordinates for rectangle preview\n      if (currentZone.points.length === 1) {\n        const updatedZone = {\n          ...currentZone,\n          points: [currentZone.points[0], displayCoords],\n          isPreview: true // Mark as preview\n        };\n        setCurrentZone(updatedZone);\n        console.log('ðŸ–±ï¸ Mouse move - updating preview:', {\n          start: currentZone.points[0],\n          current: displayCoords\n        });\n        drawZones([...zones, updatedZone]);\n      }\n    }\n    ;\n    const handleMouseUp = event => {\n      if (!isDrawing || !currentZone) return;\n      console.log('ðŸ–±ï¸ Mouse up event triggered');\n      event.preventDefault();\n\n      // Get display coordinates for the end point\n      const canvas = canvasRef.current;\n      const rect = canvas.getBoundingClientRect();\n      const scaleX = canvas.width / rect.width;\n      const scaleY = canvas.height / rect.height;\n      const displayEndCoords = {\n        x: (event.clientX - rect.left) * scaleX,\n        y: (event.clientY - rect.top) * scaleY\n      };\n\n      // Convert both start and end points from display to natural coordinates for storage\n      const backgroundImg = document.getElementById('roi-background-image');\n      let naturalStartCoords = currentZone.points[0];\n      let naturalEndCoords = displayEndCoords;\n      if (backgroundImg) {\n        const naturalWidth = backgroundImg.naturalWidth || frameWidth;\n        const naturalHeight = backgroundImg.naturalHeight || frameHeight;\n        const displayWidth = canvas.width;\n        const displayHeight = canvas.height;\n        const naturalScaleX = naturalWidth / displayWidth;\n        const naturalScaleY = naturalHeight / displayHeight;\n        naturalStartCoords = {\n          x: currentZone.points[0].x * naturalScaleX,\n          y: currentZone.points[0].y * naturalScaleY\n        };\n        naturalEndCoords = {\n          x: displayEndCoords.x * naturalScaleX,\n          y: displayEndCoords.y * naturalScaleY\n        };\n      }\n\n      // Complete rectangle zone with natural coordinates\n      if (currentZone.points.length >= 1) {\n        const newZone = {\n          ...currentZone,\n          points: [naturalStartCoords, naturalEndCoords],\n          // Store in natural coordinates\n          isComplete: true,\n          isPreview: false,\n          name: `${zoneTypes[selectedZoneType].name} ${zones.length + 1}`,\n          requiresScooper: zoneTypes[selectedZoneType].requiresScooper\n        };\n        console.log('âœ… Zone created:', {\n          display: {\n            start: currentZone.points[0],\n            end: displayEndCoords\n          },\n          natural: {\n            start: naturalStartCoords,\n            end: naturalEndCoords\n          },\n          zone: newZone\n        });\n        const newZones = [...zones, newZone];\n        setZones(newZones);\n        onZonesUpdate(newZones);\n        toast.success(`${zoneTypes[selectedZoneType].name} zone created!`);\n      }\n      setIsDrawing(false);\n      setCurrentZone(null);\n      drawZones(); // Redraw with the new zone\n    };\n    const findZoneAtPoint = (x, y) => {\n      // x, y are in natural coordinates, zones are stored in natural coordinates\n      return zones.find(zone => {\n        if (zone.points.length === 2) {\n          const [p1, p2] = zone.points;\n          const inZone = x >= Math.min(p1.x, p2.x) && x <= Math.max(p1.x, p2.x) && y >= Math.min(p1.y, p2.y) && y <= Math.max(p1.y, p2.y);\n          console.log(`ðŸ” Checking zone ${zone.name}:`, {\n            point: {\n              x,\n              y\n            },\n            zone: {\n              p1,\n              p2\n            },\n            inZone\n          });\n          return inZone;\n        }\n        return false;\n      });\n    };\n    const drawZones = (zonesToDraw = zones) => {\n      const canvas = canvasRef.current;\n      if (!canvas) {\n        console.log('âŒ No canvas reference');\n        return;\n      }\n      const ctx = canvas.getContext('2d');\n\n      // Get the background image to match its size\n      const backgroundImg = document.getElementById('roi-background-image');\n      let displayWidth, displayHeight, naturalWidth, naturalHeight;\n      if (backgroundImg) {\n        const rect = backgroundImg.getBoundingClientRect();\n        displayWidth = rect.width;\n        displayHeight = rect.height;\n        naturalWidth = backgroundImg.naturalWidth || frameWidth;\n        naturalHeight = backgroundImg.naturalHeight || frameHeight;\n        canvas.width = displayWidth;\n        canvas.height = displayHeight;\n        canvas.style.width = displayWidth + 'px';\n        canvas.style.height = displayHeight + 'px';\n      } else {\n        // Fallback to provided dimensions\n        displayWidth = frameWidth;\n        displayHeight = frameHeight;\n        naturalWidth = frameWidth;\n        naturalHeight = frameHeight;\n        canvas.width = displayWidth;\n        canvas.height = displayHeight;\n      }\n\n      // Calculate scaling factors from natural to display size\n      const scaleX = displayWidth / naturalWidth;\n      const scaleY = displayHeight / naturalHeight;\n      console.log('ðŸŽ¨ Drawing zones on canvas:', {\n        canvasSize: `${canvas.width}x${canvas.height}`,\n        frameSize: `${frameWidth}x${frameHeight}`,\n        naturalSize: `${naturalWidth}x${naturalHeight}`,\n        displaySize: `${displayWidth}x${displayHeight}`,\n        scale: `${scaleX.toFixed(3)}x${scaleY.toFixed(3)}`,\n        zones: zonesToDraw.length,\n        backgroundImg: !!backgroundImg\n      });\n\n      // Clear canvas\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      if (!showZones) return;\n\n      // Draw each zone with proper coordinate scaling\n      zonesToDraw.forEach((zone, index) => {\n        const zoneConfig = zoneTypes[zone.type];\n        if (zone.shape === 'polygon' && zone.points.length >= 3) {\n          drawPolygonZone(ctx, zone, zoneConfig, scaleX, scaleY);\n        } else if (zone.points.length >= 2) {\n          drawRectangleZone(ctx, zone, zoneConfig, scaleX, scaleY);\n        }\n      });\n\n      // Draw current polygon being drawn\n      if (drawingMode === 'polygon' && polygonPoints.length > 0) {\n        drawPolygonPreview(ctx, polygonPoints, previewPoint, zoneTypes[selectedZoneType]);\n      }\n\n      // Draw current zone being drawn (rectangle mode)\n      if (drawingMode === 'rectangle' && currentZone && currentZone.points.length === 2) {\n        const zoneConfig = zoneTypes[currentZone.type];\n        const [p1, p2] = currentZone.points;\n        ctx.strokeStyle = zoneConfig.color;\n        ctx.lineWidth = 3;\n        ctx.setLineDash([10, 5]);\n        ctx.strokeRect(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y), Math.abs(p2.x - p1.x), Math.abs(p2.y - p1.y));\n      }\n    };\n    const drawPolygonZone = (ctx, zone, zoneConfig, scaleX, scaleY) => {\n      const isPreviewZone = zone.isPreview === true;\n\n      // Scale points from natural to display coordinates (unless it's a preview)\n      const scaledPoints = zone.points.map(point => {\n        if (isPreviewZone) {\n          return point; // Already in display coordinates\n        } else {\n          return {\n            x: point.x * scaleX,\n            y: point.y * scaleY\n          };\n        }\n      });\n\n      // Draw polygon\n      ctx.save();\n      ctx.strokeStyle = zoneConfig.color;\n      ctx.fillStyle = zoneConfig.fillColor;\n      ctx.lineWidth = isPreviewZone ? 3 : 2;\n      ctx.setLineDash(isPreviewZone ? [5, 5] : []);\n      ctx.beginPath();\n      ctx.moveTo(scaledPoints[0].x, scaledPoints[0].y);\n      for (let i = 1; i < scaledPoints.length; i++) {\n        ctx.lineTo(scaledPoints[i].x, scaledPoints[i].y);\n      }\n      ctx.closePath();\n      ctx.fill();\n      ctx.stroke();\n\n      // Draw points\n      scaledPoints.forEach((point, index) => {\n        ctx.beginPath();\n        ctx.arc(point.x, point.y, 4, 0, 2 * Math.PI);\n        ctx.fillStyle = zoneConfig.color;\n        ctx.fill();\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 1;\n        ctx.stroke();\n      });\n\n      // Draw zone label\n      const centerX = scaledPoints.reduce((sum, p) => sum + p.x, 0) / scaledPoints.length;\n      const centerY = scaledPoints.reduce((sum, p) => sum + p.y, 0) / scaledPoints.length;\n      ctx.fillStyle = '#fff';\n      ctx.font = 'bold 12px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText(`${zoneConfig.icon} ${zone.name}`, centerX, centerY);\n      ctx.restore();\n    };\n    const drawPolygonPreview = (ctx, points, previewPoint, zoneConfig) => {\n      if (points.length === 0) return;\n      ctx.save();\n      ctx.strokeStyle = zoneConfig.color;\n      ctx.lineWidth = 3;\n      ctx.setLineDash([5, 5]);\n\n      // Draw lines between points\n      ctx.beginPath();\n      ctx.moveTo(points[0].x, points[0].y);\n      for (let i = 1; i < points.length; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n      }\n\n      // Draw preview line to mouse\n      if (previewPoint) {\n        ctx.lineTo(previewPoint.x, previewPoint.y);\n      }\n      ctx.stroke();\n\n      // Draw points\n      points.forEach((point, index) => {\n        ctx.beginPath();\n        ctx.arc(point.x, point.y, 6, 0, 2 * Math.PI);\n        ctx.fillStyle = zoneConfig.color;\n        ctx.fill();\n        ctx.strokeStyle = '#fff';\n        ctx.lineWidth = 2;\n        ctx.stroke();\n\n        // Draw point number\n        ctx.fillStyle = '#fff';\n        ctx.font = '10px Arial';\n        ctx.textAlign = 'center';\n        ctx.fillText((index + 1).toString(), point.x, point.y + 3);\n      });\n      ctx.restore();\n    };\n    const drawRectangleZone = (ctx, zone, zoneConfig, scaleX, scaleY) => {\n      const [p1, p2] = zone.points;\n      const isPreviewZone = zone.isPreview === true;\n\n      // Scale coordinates from natural to display (unless it's a preview)\n      let x1, y1, x2, y2;\n      if (isPreviewZone) {\n        x1 = p1.x;\n        y1 = p1.y;\n        x2 = p2.x;\n        y2 = p2.y;\n      } else {\n        x1 = p1.x * scaleX;\n        y1 = p1.y * scaleY;\n        x2 = p2.x * scaleX;\n        y2 = p2.y * scaleY;\n      }\n      const width = Math.abs(x2 - x1);\n      const height = Math.abs(y2 - y1);\n      const startX = Math.min(x1, x2);\n      const startY = Math.min(y1, y2);\n\n      // Draw rectangle\n      ctx.save();\n      ctx.fillStyle = zoneConfig.fillColor;\n      ctx.fillRect(startX, startY, width, height);\n      ctx.strokeStyle = zoneConfig.color;\n      ctx.lineWidth = isPreviewZone ? 3 : 2;\n      ctx.setLineDash(isPreviewZone ? [10, 5] : []);\n      ctx.strokeRect(startX, startY, width, height);\n\n      // Draw zone label\n      const labelX = startX + width / 2;\n      const labelY = startY + height / 2;\n      ctx.fillStyle = '#fff';\n      ctx.font = 'bold 14px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText(`${zoneConfig.icon} ${zone.name || zoneConfig.name}`, labelX, labelY);\n\n      // Draw requirement text\n      const reqText = zone.requiresScooper ? 'Scooper Required' : 'No Scooper Required';\n      ctx.font = '12px Arial';\n      ctx.fillStyle = zone.requiresScooper ? '#FF4757' : '#2ED573';\n      ctx.fillText(reqText, labelX, labelY + 18);\n      ctx.restore();\n    };\n    const deleteZone = zoneId => {\n      setZones(zones.filter(zone => zone.id !== zoneId));\n      setEditingZone(null);\n      toast.info('Zone deleted');\n    };\n    const clearAllZones = () => {\n      setZones([]);\n      setEditingZone(null);\n      toast.info('All zones cleared');\n    };\n    const exportZones = () => {\n      const exportData = {\n        zones: zones.map(zone => ({\n          ...zone,\n          // Convert to relative coordinates (0-1)\n          points: zone.points.map(p => ({\n            x: p.x / frameWidth,\n            y: p.y / frameHeight\n          }))\n        })),\n        frameSize: {\n          width: frameWidth,\n          height: frameHeight\n        },\n        exportedAt: new Date().toISOString()\n      };\n      const blob = new Blob([JSON.stringify(exportData, null, 2)], {\n        type: 'application/json'\n      });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `roi_zones_${Date.now()}.json`;\n      a.click();\n      URL.revokeObjectURL(url);\n      toast.success('Zones exported successfully!');\n    }; // exportZones function closing\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: '100%'\n      },\n      children: [isEnabled && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: '16px',\n          padding: '16px',\n          background: 'rgba(255,255,255,0.1)',\n          borderRadius: '8px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            margin: '0 0 12px 0',\n            color: '#fff'\n          },\n          children: \"\\uD83C\\uDFAF ROI Zone Manager\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 667,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              marginBottom: '6px',\n              fontWeight: 'bold'\n            },\n            children: \"Zone Type:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 671,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            value: selectedZoneType,\n            onChange: e => setSelectedZoneType(e.target.value),\n            style: {\n              padding: '8px',\n              borderRadius: '6px',\n              border: '1px solid rgba(255,255,255,0.3)',\n              background: 'rgba(255,255,255,0.1)',\n              color: 'white',\n              width: '200px'\n            },\n            children: Object.entries(zoneTypes).map(([key, config]) => /*#__PURE__*/_jsxDEV(\"option\", {\n              value: key,\n              style: {\n                background: '#333',\n                color: 'white'\n              },\n              children: [config.icon, \" \", config.name]\n            }, key, true, {\n              fileName: _jsxFileName,\n              lineNumber: 687,\n              columnNumber: 15\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 674,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 670,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginBottom: '12px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              display: 'block',\n              marginBottom: '6px',\n              fontWeight: 'bold'\n            },\n            children: \"Drawing Mode:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 696,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '8px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setDrawingMode('rectangle'),\n              style: {\n                padding: '8px 12px',\n                borderRadius: '6px',\n                border: drawingMode === 'rectangle' ? '2px solid #00FF88' : '1px solid rgba(255,255,255,0.3)',\n                background: drawingMode === 'rectangle' ? 'rgba(0,255,136,0.2)' : 'rgba(255,255,255,0.1)',\n                color: drawingMode === 'rectangle' ? '#00FF88' : '#fff',\n                cursor: 'pointer',\n                fontSize: '12px'\n              },\n              children: \"\\uD83D\\uDCE6 Rectangle\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 700,\n              columnNumber: 13\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => setDrawingMode('polygon'),\n              style: {\n                padding: '8px 12px',\n                borderRadius: '6px',\n                border: drawingMode === 'polygon' ? '2px solid #FF6B35' : '1px solid rgba(255,255,255,0.3)',\n                background: drawingMode === 'polygon' ? 'rgba(255,107,53,0.2)' : 'rgba(255,255,255,0.1)',\n                color: drawingMode === 'polygon' ? '#FF6B35' : '#fff',\n                cursor: 'pointer',\n                fontSize: '12px'\n              },\n              children: \"\\uD83D\\uDD3A Polygon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 714,\n              columnNumber: 13\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 699,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: '#ccc',\n              marginTop: '4px'\n            },\n            children: drawingMode === 'rectangle' ? 'ðŸ“¦ Click and drag to create rectangular zones' : 'ðŸ”º Click points to create polygon zones (perfect for sauce areas)'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 729,\n            columnNumber: 11\n          }, this), ((_zoneTypes$selectedZo = zoneTypes[selectedZoneType]) === null || _zoneTypes$selectedZo === void 0 ? void 0 : _zoneTypes$selectedZo.preferredShape) && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '11px',\n              color: zoneTypes[selectedZoneType].preferredShape === 'polygon' ? '#FF6B35' : '#FFD23F',\n              marginTop: '2px',\n              fontStyle: 'italic'\n            },\n            children: [\"\\uD83D\\uDCA1 Recommended: \", zoneTypes[selectedZoneType].preferredShape, \" for \", zoneTypes[selectedZoneType].name]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 736,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 695,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '8px 12px',\n            background: isEnabled ? 'rgba(0,255,136,0.2)' : 'rgba(255,255,255,0.1)',\n            borderRadius: '6px',\n            marginBottom: '12px',\n            border: `2px solid ${isEnabled ? '#00FF88' : 'rgba(255,255,255,0.3)'}`\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: isEnabled ? '#00FF88' : '#fff'\n            },\n            children: isEnabled ? drawingMode === 'polygon' ? 'ðŸ”º Polygon Mode: ACTIVE - Click points to create polygon zones' : 'ðŸ“¦ Rectangle Mode: ACTIVE - Click and drag to create zones' : 'ðŸ”’ Drawing Mode: DISABLED'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 755,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              marginTop: '4px',\n              opacity: 0.8\n            },\n            children: [\"Debug: isEnabled=\", isEnabled.toString(), \", currentFrame=\", !!currentFrame ? 'available' : 'none', \", frameSize=\", frameWidth, \"x\", frameHeight]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 764,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 748,\n          columnNumber: 9\n        }, this), drawingMode === 'polygon' && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '8px 12px',\n            background: 'rgba(255,107,53,0.2)',\n            borderRadius: '6px',\n            marginBottom: '12px',\n            border: '2px solid #FF6B35'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#FF6B35',\n              fontWeight: 'bold',\n              marginBottom: '8px'\n            },\n            children: \"\\uD83D\\uDD3A Polygon Drawing Status\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 779,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              color: '#fff',\n              marginBottom: '8px'\n            },\n            children: [polygonPoints.length === 0 && 'Click to start drawing polygon', polygonPoints.length > 0 && polygonPoints.length < 3 && `${polygonPoints.length} points added. Need ${3 - polygonPoints.length} more.`, polygonPoints.length >= 3 && `${polygonPoints.length} points. Click near first point to close polygon.`]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 782,\n            columnNumber: 13\n          }, this), polygonPoints.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              display: 'flex',\n              gap: '6px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                if (polygonPoints.length > 0) {\n                  const newPoints = polygonPoints.slice(0, -1);\n                  setPolygonPoints(newPoints);\n                  if (newPoints.length === 0) {\n                    setIsDrawing(false);\n                    setPreviewPoint(null);\n                  }\n                  toast.info('Last point removed');\n                }\n              },\n              style: {\n                padding: '4px 8px',\n                background: '#FF9800',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontSize: '11px'\n              },\n              children: \"\\u21B6 Undo Point\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 791,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                setPolygonPoints([]);\n                setIsDrawing(false);\n                setPreviewPoint(null);\n                toast.info('Polygon cleared');\n              },\n              style: {\n                padding: '4px 8px',\n                background: '#f44336',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontSize: '11px'\n              },\n              children: \"\\uD83D\\uDDD1\\uFE0F Clear\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 815,\n              columnNumber: 17\n            }, this), polygonPoints.length >= 3 && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: completePolygon,\n              style: {\n                padding: '4px 8px',\n                background: '#4CAF50',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontSize: '11px'\n              },\n              children: \"\\u2705 Complete\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 835,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 790,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 772,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '8px',\n            flexWrap: 'wrap',\n            alignItems: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary\",\n            onClick: () => setShowZones(!showZones),\n            children: showZones ? 'ðŸ‘ï¸ Hide Zones' : 'ðŸ‘ï¸â€ðŸ—¨ï¸ Show Zones'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 857,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-warning\",\n            onClick: clearAllZones,\n            disabled: zones.length === 0,\n            children: \"\\uD83D\\uDDD1\\uFE0F Clear All\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 864,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-success\",\n            onClick: exportZones,\n            disabled: zones.length === 0,\n            children: \"\\uD83D\\uDCE5 Export Zones\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 872,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-info\",\n            onClick: () => {\n              // Add a test zone to verify functionality\n              const testZone = {\n                id: `test_zone_${Date.now()}`,\n                type: selectedZoneType,\n                points: [{\n                  x: 50,\n                  y: 50\n                }, {\n                  x: 200,\n                  y: 150\n                }],\n                isComplete: true,\n                name: `Test ${zoneTypes[selectedZoneType].name}`,\n                requiresScooper: zoneTypes[selectedZoneType].requiresScooper\n              };\n              setZones([...zones, testZone]);\n              toast.success('Test zone added!');\n            },\n            children: \"\\uD83E\\uDDEA Add Test Zone\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 880,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              marginLeft: '16px',\n              fontSize: '14px',\n              opacity: 0.8\n            },\n            children: [\"Zones: \", zones.length, \" | \", isEnabled ? 'Click and drag to create zones' : 'Enable drawing to create zones']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 902,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 856,\n          columnNumber: 9\n        }, this), isEnabled && zones.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '12px',\n            background: 'rgba(255,210,63,0.2)',\n            borderRadius: '6px',\n            marginTop: '8px',\n            border: '2px dashed #FFD23F'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: '#FFD23F',\n              fontWeight: 'bold',\n              marginBottom: '4px'\n            },\n            children: \"\\uD83D\\uDCDD How to Draw Zones:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 916,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '14px',\n              opacity: 0.9\n            },\n            children: [\"1. Select zone type above (e.g., \\\"\\uD83C\\uDF45 Sauce Area\\\")\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 920,\n              columnNumber: 64\n            }, this), \"2. Click and hold on the video to start drawing\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 921,\n              columnNumber: 62\n            }, this), \"3. Drag to create a rectangle\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 922,\n              columnNumber: 44\n            }, this), \"4. Release to complete the zone\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 919,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 909,\n          columnNumber: 11\n        }, this), isDrawing && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            padding: '8px 12px',\n            background: 'rgba(0,212,255,0.3)',\n            borderRadius: '6px',\n            marginTop: '8px',\n            textAlign: 'center',\n            border: '2px solid #00D4FF'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: '#00D4FF',\n              fontWeight: 'bold'\n            },\n            children: \"\\uD83C\\uDFA8 Drawing in progress... Drag to set zone size\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 937,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 929,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 661,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          position: 'relative',\n          display: 'inline-block',\n          width: '100%',\n          maxWidth: '100%',\n          background: '#000',\n          borderRadius: '8px',\n          overflow: 'hidden'\n        },\n        children: [currentFrame && /*#__PURE__*/_jsxDEV(\"img\", {\n          id: \"roi-background-image\",\n          src: `data:image/jpeg;base64,${currentFrame}`,\n          alt: \"Video frame for zone configuration\",\n          style: {\n            width: '100%',\n            height: 'auto',\n            display: 'block',\n            borderRadius: '8px'\n          },\n          onLoad: e => {\n            console.log('ðŸŽ¯ ROI Manager: Video frame loaded');\n            const img = e.target;\n            const rect = img.getBoundingClientRect();\n            console.log('ðŸ“ Image dimensions:', {\n              natural: `${img.naturalWidth}x${img.naturalHeight}`,\n              display: `${rect.width}x${rect.height}`\n            });\n\n            // Update canvas size to match image\n            const canvas = canvasRef.current;\n            if (canvas) {\n              canvas.width = rect.width;\n              canvas.height = rect.height;\n              canvas.style.width = rect.width + 'px';\n              canvas.style.height = rect.height + 'px';\n              console.log('ðŸŽ¨ Canvas resized to match image');\n            }\n            setTimeout(() => drawZones(), 100);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 957,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          style: {\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            cursor: isEnabled ? 'crosshair' : 'default',\n            pointerEvents: isEnabled ? 'auto' : 'none',\n            zIndex: 20,\n            borderRadius: '8px'\n          },\n          onMouseDown: handleMouseDown,\n          onMouseMove: handleMouseMove,\n          onMouseUp: handleMouseUp,\n          onContextMenu: e => e.preventDefault()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 992,\n          columnNumber: 9\n        }, this), !currentFrame && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: '100%',\n            height: '300px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            background: 'rgba(255,255,255,0.1)',\n            color: 'rgba(255,255,255,0.6)'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              textAlign: 'center'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '48px',\n                marginBottom: '16px'\n              },\n              children: \"\\uD83C\\uDFA5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1020,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Video frame will appear here\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1021,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1019,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1010,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 946,\n        columnNumber: 7\n      }, this), isEnabled && zones.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '16px',\n          padding: '16px',\n          background: 'rgba(255,255,255,0.05)',\n          borderRadius: '8px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n          style: {\n            margin: '0 0 12px 0'\n          },\n          children: [\"\\uD83D\\uDCCB Active Zones (\", zones.length, \")\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1035,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            maxHeight: '200px',\n            overflowY: 'auto'\n          },\n          children: zones.map((zone, index) => {\n            const config = zoneTypes[zone.type];\n            return /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center',\n                padding: '8px 12px',\n                marginBottom: '8px',\n                background: (editingZone === null || editingZone === void 0 ? void 0 : editingZone.id) === zone.id ? 'rgba(255,255,255,0.2)' : 'rgba(255,255,255,0.1)',\n                borderRadius: '6px',\n                border: `2px solid ${config.color}`\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: [config.icon, \" \", zone.name]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1054,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1055,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"small\", {\n                  style: {\n                    opacity: 0.8\n                  },\n                  children: [config.description, \" | Scooper: \", zone.requiresScooper ? 'ðŸ¥„ Required' : 'ðŸš« Not Required']\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1056,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1053,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => deleteZone(zone.id),\n                style: {\n                  background: '#FF4757',\n                  border: 'none',\n                  borderRadius: '4px',\n                  padding: '4px 8px',\n                  color: 'white',\n                  cursor: 'pointer',\n                  fontSize: '12px'\n                },\n                children: \"\\uD83D\\uDDD1\\uFE0F Delete\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1060,\n                columnNumber: 19\n              }, this)]\n            }, zone.id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1040,\n              columnNumber: 17\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1036,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1029,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 658,\n      columnNumber: 5\n    }, this);\n  }; // Missing closing brace added\n}; // Main component closing brace\n_s(ROIZoneManager, \"QjdcVgD3/3Gp4zfdOX2HoSd9T9c=\");\n_c = ROIZoneManager;\nexport default ROIZoneManager;\nvar _c;\n$RefreshReg$(_c, \"ROIZoneManager\");","map":{"version":3,"names":["React","useState","useRef","useEffect","toast","jsxDEV","_jsxDEV","ROIZoneManager","currentFrame","onZonesUpdate","existingZones","isEnabled","frameWidth","frameHeight","_s","canvasRef","zones","setZones","isDrawing","setIsDrawing","currentZone","setCurrentZone","selectedZoneType","setSelectedZoneType","editingZone","setEditingZone","showZones","setShowZones","drawingMode","setDrawingMode","polygonPoints","setPolygonPoints","previewPoint","setPreviewPoint","zoneTypes","sauce_area","name","color","fillColor","requiresScooper","icon","description","preferredShape","cheese_area","meat_area","vegetable_area","prep_surface","cleaning_area","drawZones","getCanvasCoordinates","event","canvas","current","x","y","rect","getBoundingClientRect","scaleX","width","scaleY","height","displayCoords","clientX","left","clientY","top","backgroundImg","document","getElementById","naturalCoords","naturalWidth","naturalHeight","displayWidth","displayHeight","naturalScaleX","naturalScaleY","console","log","client","display","natural","frame","handleMouseDown","preventDefault","clickedZone","findZoneAtPoint","handlePolygonClick","handleRectangleStart","length","firstPoint","distance","Math","sqrt","pow","completePolygon","newPoints","info","id","Date","now","type","points","isComplete","isPreview","shape","error","naturalPoints","map","point","newZone","newZones","success","handleMouseMove","_zoneTypes$selectedZo","updatedZone","start","handleMouseUp","displayEndCoords","naturalStartCoords","naturalEndCoords","end","zone","find","p1","p2","inZone","min","max","zonesToDraw","ctx","getContext","style","canvasSize","frameSize","naturalSize","displaySize","scale","toFixed","clearRect","forEach","index","zoneConfig","drawPolygonZone","drawRectangleZone","drawPolygonPreview","strokeStyle","lineWidth","setLineDash","strokeRect","abs","isPreviewZone","scaledPoints","save","fillStyle","beginPath","moveTo","i","lineTo","closePath","fill","stroke","arc","PI","centerX","reduce","sum","p","centerY","font","textAlign","fillText","restore","toString","x1","y1","x2","y2","startX","startY","fillRect","labelX","labelY","reqText","deleteZone","zoneId","filter","clearAllZones","exportZones","exportData","exportedAt","toISOString","blob","Blob","JSON","stringify","url","URL","createObjectURL","a","createElement","href","download","click","revokeObjectURL","children","marginBottom","padding","background","borderRadius","margin","fileName","_jsxFileName","lineNumber","columnNumber","fontWeight","value","onChange","e","target","border","Object","entries","key","config","gap","onClick","cursor","fontSize","marginTop","fontStyle","opacity","slice","flexWrap","alignItems","className","disabled","testZone","marginLeft","position","maxWidth","overflow","src","alt","onLoad","img","setTimeout","ref","pointerEvents","zIndex","onMouseDown","onMouseMove","onMouseUp","onContextMenu","justifyContent","maxHeight","overflowY","_c","$RefreshReg$"],"sources":["C:/Users/ayoub/OneDrive/Desktop/eagleAI/pizza_store_detection/services/frontend/src/components/ROIZoneManager.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport { toast } from 'react-toastify';\n\n\nconst ROIZoneManager = ({ \n  currentFrame, \n  onZonesUpdate, \n  existingZones = [], \n  isEnabled = true,\n  frameWidth = 640,\n  frameHeight = 480 \n}) => {\n  const canvasRef = useRef(null);\n  const [zones, setZones] = useState(existingZones);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [currentZone, setCurrentZone] = useState(null);\n  const [selectedZoneType, setSelectedZoneType] = useState('sauce_area');\n  const [editingZone, setEditingZone] = useState(null);\n  const [showZones, setShowZones] = useState(true);\n\n  // New polygon drawing states\n  const [drawingMode, setDrawingMode] = useState('rectangle'); // 'rectangle' or 'polygon'\n  const [polygonPoints, setPolygonPoints] = useState([]);\n  const [previewPoint, setPreviewPoint] = useState(null);\n\n  // Zone types with professional configuration\n  const zoneTypes = {\n    sauce_area: {\n      name: 'Sauce Area',\n      color: '#FF6B35',\n      fillColor: 'rgba(255, 107, 53, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ…',\n      description: 'Sauce dispensing and handling area',\n      preferredShape: 'polygon' // Sauce areas work better with polygons\n    },\n    cheese_area: {\n      name: 'Cheese Area',\n      color: '#FFD23F',\n      fillColor: 'rgba(255, 210, 63, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ§€',\n      description: 'Cheese container and handling area',\n      preferredShape: 'rectangle' // Cheese containers are usually rectangular\n    },\n    meat_area: {\n      name: 'Meat/Protein Area',\n      color: '#FF4757',\n      fillColor: 'rgba(255, 71, 87, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ¥“',\n      description: 'Meat and protein ingredient area'\n    },\n    vegetable_area: {\n      name: 'Vegetable Area',\n      color: '#2ED573',\n      fillColor: 'rgba(46, 213, 115, 0.2)',\n      requiresScooper: true,\n      icon: 'ðŸ¥¬',\n      description: 'Vegetable and fresh ingredient area'\n    },\n    prep_surface: {\n      name: 'Prep Surface',\n      color: '#5352ED',\n      fillColor: 'rgba(83, 82, 237, 0.2)',\n      requiresScooper: false,\n      icon: 'ðŸ•',\n      description: 'Pizza preparation surface (no scooper required)'\n    },\n    cleaning_area: {\n      name: 'Cleaning Area',\n      color: '#00D2D3',\n      fillColor: 'rgba(0, 210, 211, 0.2)',\n      requiresScooper: false,\n      icon: 'ðŸ§½',\n      description: 'Cleaning and sanitization area'\n    }\n  };\n\n  useEffect(() => {\n    if (onZonesUpdate) {\n      onZonesUpdate(zones);\n    }\n  }, [zones, onZonesUpdate]);\n\n  useEffect(() => {\n    drawZones();\n  }, [zones, currentFrame, showZones, frameWidth, frameHeight]);\n\n  const getCanvasCoordinates = (event) => {\n    const canvas = canvasRef.current;\n    if (!canvas) return { x: 0, y: 0 };\n\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    // Get display coordinates\n    const displayCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n\n    // Convert to natural frame coordinates for storage\n    const backgroundImg = document.getElementById('roi-background-image');\n    let naturalCoords = displayCoords;\n\n    if (backgroundImg) {\n      const naturalWidth = backgroundImg.naturalWidth || frameWidth;\n      const naturalHeight = backgroundImg.naturalHeight || frameHeight;\n      const displayWidth = canvas.width;\n      const displayHeight = canvas.height;\n\n      const naturalScaleX = naturalWidth / displayWidth;\n      const naturalScaleY = naturalHeight / displayHeight;\n\n      naturalCoords = {\n        x: displayCoords.x * naturalScaleX,\n        y: displayCoords.y * naturalScaleY\n      };\n    }\n\n    console.log('ðŸ–±ï¸ Mouse coordinates:', {\n      client: { x: event.clientX, y: event.clientY },\n      display: displayCoords,\n      natural: naturalCoords,\n      canvas: { width: canvas.width, height: canvas.height },\n      frame: { width: frameWidth, height: frameHeight }\n    });\n\n    return naturalCoords;\n  };\n\n  const handleMouseDown = (event) => {\n    if (!isEnabled) {\n      console.log('ðŸš« Drawing disabled');\n      return;\n    }\n\n    console.log('ðŸ–±ï¸ Mouse down event triggered');\n    event.preventDefault();\n\n    // Get both natural and display coordinates\n    const naturalCoords = getCanvasCoordinates(event); // This returns natural coordinates\n\n    // Also get display coordinates for drawing preview\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    const displayCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n\n    // Check if clicking on existing zone for editing (use natural coordinates)\n    const clickedZone = findZoneAtPoint(naturalCoords.x, naturalCoords.y);\n    if (clickedZone) {\n      console.log('âœï¸ Editing existing zone:', clickedZone.name);\n      setEditingZone(clickedZone);\n      return;\n    }\n\n    if (drawingMode === 'polygon') {\n      handlePolygonClick(displayCoords, naturalCoords);\n    } else {\n      handleRectangleStart(displayCoords, naturalCoords);\n    }\n  };\n\n  const handlePolygonClick = (displayCoords, naturalCoords) => {\n    // Check if clicking near the first point to close polygon\n    if (polygonPoints.length > 2) {\n      const firstPoint = polygonPoints[0];\n      const distance = Math.sqrt(\n        Math.pow(displayCoords.x - firstPoint.x, 2) + Math.pow(displayCoords.y - firstPoint.y, 2)\n      );\n\n      if (distance < 15) {\n        // Close polygon\n        completePolygon();\n        return;\n      }\n    }\n\n    // Add new point to polygon\n    const newPoints = [...polygonPoints, displayCoords];\n    setPolygonPoints(newPoints);\n    setIsDrawing(true);\n\n    toast.info(`Point ${newPoints.length} added. ${newPoints.length > 2 ? 'Click near first point to close.' : ''}`);\n  };\n\n  const handleRectangleStart = (displayCoords, naturalCoords) => {\n    // Start drawing new rectangle zone with display coordinates for preview\n    console.log('ðŸ“¦ Starting rectangle zone drawing:', {\n      display: displayCoords,\n      natural: naturalCoords\n    });\n    setIsDrawing(true);\n    setCurrentZone({\n      id: `zone_${Date.now()}`,\n      type: selectedZoneType,\n      points: [displayCoords], // Use display coordinates for preview\n      isComplete: false,\n      isPreview: true,\n      shape: 'rectangle'\n    });\n  };\n\n  const completePolygon = () => {\n    if (polygonPoints.length < 3) {\n      toast.error('Polygon must have at least 3 points');\n      return;\n    }\n\n    // Convert display coordinates to natural coordinates for storage\n    const naturalPoints = polygonPoints.map(point => {\n      const canvas = canvasRef.current;\n      const rect = canvas.getBoundingClientRect();\n      const scaleX = frameWidth / canvas.width;\n      const scaleY = frameHeight / canvas.height;\n\n      return {\n        x: point.x * scaleX,\n        y: point.y * scaleY\n      };\n    });\n\n    const newZone = {\n      id: `zone_${Date.now()}`,\n      type: selectedZoneType,\n      shape: 'polygon',\n      points: naturalPoints,\n      isComplete: true,\n      isPreview: false,\n      name: `${zoneTypes[selectedZoneType].name} ${zones.length + 1}`,\n      requiresScooper: zoneTypes[selectedZoneType].requiresScooper\n    };\n\n    const newZones = [...zones, newZone];\n    setZones(newZones);\n    onZonesUpdate(newZones);\n\n    // Reset polygon drawing state\n    setPolygonPoints([]);\n    setIsDrawing(false);\n    setPreviewPoint(null);\n\n    toast.success(`${zoneTypes[selectedZoneType].name} polygon zone created!`);\n    drawZones(); // Redraw with the new zone\n  };\n\n  const handleMouseMove = (event) => {\n    if (!isEnabled) return;\n\n    event.preventDefault();\n\n    // Get display coordinates for preview\n    const canvas = canvasRef.current;\n    if (!canvas) return;\n\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    const displayCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n\n    if (drawingMode === 'polygon' && isDrawing && polygonPoints.length > 0) {\n      // Update preview point for polygon\n      setPreviewPoint(displayCoords);\n    } else if (drawingMode === 'rectangle' && isDrawing && currentZone) {\n      // Update current zone with display coordinates for rectangle preview\n      if (currentZone.points.length === 1) {\n        const updatedZone = {\n          ...currentZone,\n          points: [currentZone.points[0], displayCoords],\n          isPreview: true // Mark as preview\n        };\n        setCurrentZone(updatedZone);\n      console.log('ðŸ–±ï¸ Mouse move - updating preview:', {\n        start: currentZone.points[0],\n        current: displayCoords\n      });\n      drawZones([...zones, updatedZone]);\n    }\n  };\n\n  const handleMouseUp = (event) => {\n    if (!isDrawing || !currentZone) return;\n\n    console.log('ðŸ–±ï¸ Mouse up event triggered');\n    event.preventDefault();\n\n    // Get display coordinates for the end point\n    const canvas = canvasRef.current;\n    const rect = canvas.getBoundingClientRect();\n    const scaleX = canvas.width / rect.width;\n    const scaleY = canvas.height / rect.height;\n\n    const displayEndCoords = {\n      x: (event.clientX - rect.left) * scaleX,\n      y: (event.clientY - rect.top) * scaleY\n    };\n\n    // Convert both start and end points from display to natural coordinates for storage\n    const backgroundImg = document.getElementById('roi-background-image');\n    let naturalStartCoords = currentZone.points[0];\n    let naturalEndCoords = displayEndCoords;\n\n    if (backgroundImg) {\n      const naturalWidth = backgroundImg.naturalWidth || frameWidth;\n      const naturalHeight = backgroundImg.naturalHeight || frameHeight;\n      const displayWidth = canvas.width;\n      const displayHeight = canvas.height;\n\n      const naturalScaleX = naturalWidth / displayWidth;\n      const naturalScaleY = naturalHeight / displayHeight;\n\n      naturalStartCoords = {\n        x: currentZone.points[0].x * naturalScaleX,\n        y: currentZone.points[0].y * naturalScaleY\n      };\n\n      naturalEndCoords = {\n        x: displayEndCoords.x * naturalScaleX,\n        y: displayEndCoords.y * naturalScaleY\n      };\n    }\n\n    // Complete rectangle zone with natural coordinates\n    if (currentZone.points.length >= 1) {\n      const newZone = {\n        ...currentZone,\n        points: [naturalStartCoords, naturalEndCoords], // Store in natural coordinates\n        isComplete: true,\n        isPreview: false,\n        name: `${zoneTypes[selectedZoneType].name} ${zones.length + 1}`,\n        requiresScooper: zoneTypes[selectedZoneType].requiresScooper\n      };\n\n      console.log('âœ… Zone created:', {\n        display: { start: currentZone.points[0], end: displayEndCoords },\n        natural: { start: naturalStartCoords, end: naturalEndCoords },\n        zone: newZone\n      });\n\n      const newZones = [...zones, newZone];\n      setZones(newZones);\n      onZonesUpdate(newZones);\n      toast.success(`${zoneTypes[selectedZoneType].name} zone created!`);\n    }\n\n    setIsDrawing(false);\n    setCurrentZone(null);\n    drawZones(); // Redraw with the new zone\n  };\n\n  const findZoneAtPoint = (x, y) => {\n    // x, y are in natural coordinates, zones are stored in natural coordinates\n    return zones.find(zone => {\n      if (zone.points.length === 2) {\n        const [p1, p2] = zone.points;\n        const inZone = x >= Math.min(p1.x, p2.x) && x <= Math.max(p1.x, p2.x) &&\n                      y >= Math.min(p1.y, p2.y) && y <= Math.max(p1.y, p2.y);\n\n        console.log(`ðŸ” Checking zone ${zone.name}:`, {\n          point: { x, y },\n          zone: { p1, p2 },\n          inZone\n        });\n\n        return inZone;\n      }\n      return false;\n    });\n  };\n\n  const drawZones = (zonesToDraw = zones) => {\n    const canvas = canvasRef.current;\n    if (!canvas) {\n      console.log('âŒ No canvas reference');\n      return;\n    }\n\n    const ctx = canvas.getContext('2d');\n\n    // Get the background image to match its size\n    const backgroundImg = document.getElementById('roi-background-image');\n    let displayWidth, displayHeight, naturalWidth, naturalHeight;\n\n    if (backgroundImg) {\n      const rect = backgroundImg.getBoundingClientRect();\n      displayWidth = rect.width;\n      displayHeight = rect.height;\n      naturalWidth = backgroundImg.naturalWidth || frameWidth;\n      naturalHeight = backgroundImg.naturalHeight || frameHeight;\n\n      canvas.width = displayWidth;\n      canvas.height = displayHeight;\n      canvas.style.width = displayWidth + 'px';\n      canvas.style.height = displayHeight + 'px';\n    } else {\n      // Fallback to provided dimensions\n      displayWidth = frameWidth;\n      displayHeight = frameHeight;\n      naturalWidth = frameWidth;\n      naturalHeight = frameHeight;\n      canvas.width = displayWidth;\n      canvas.height = displayHeight;\n    }\n\n    // Calculate scaling factors from natural to display size\n    const scaleX = displayWidth / naturalWidth;\n    const scaleY = displayHeight / naturalHeight;\n\n    console.log('ðŸŽ¨ Drawing zones on canvas:', {\n      canvasSize: `${canvas.width}x${canvas.height}`,\n      frameSize: `${frameWidth}x${frameHeight}`,\n      naturalSize: `${naturalWidth}x${naturalHeight}`,\n      displaySize: `${displayWidth}x${displayHeight}`,\n      scale: `${scaleX.toFixed(3)}x${scaleY.toFixed(3)}`,\n      zones: zonesToDraw.length,\n      backgroundImg: !!backgroundImg\n    });\n    \n    // Clear canvas\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    \n    if (!showZones) return;\n\n    // Draw each zone with proper coordinate scaling\n    zonesToDraw.forEach((zone, index) => {\n      const zoneConfig = zoneTypes[zone.type];\n\n      if (zone.shape === 'polygon' && zone.points.length >= 3) {\n        drawPolygonZone(ctx, zone, zoneConfig, scaleX, scaleY);\n      } else if (zone.points.length >= 2) {\n        drawRectangleZone(ctx, zone, zoneConfig, scaleX, scaleY);\n      }\n    });\n\n    // Draw current polygon being drawn\n    if (drawingMode === 'polygon' && polygonPoints.length > 0) {\n      drawPolygonPreview(ctx, polygonPoints, previewPoint, zoneTypes[selectedZoneType]);\n    }\n\n    // Draw current zone being drawn (rectangle mode)\n    if (drawingMode === 'rectangle' && currentZone && currentZone.points.length === 2) {\n      const zoneConfig = zoneTypes[currentZone.type];\n      const [p1, p2] = currentZone.points;\n\n      ctx.strokeStyle = zoneConfig.color;\n      ctx.lineWidth = 3;\n      ctx.setLineDash([10, 5]);\n      ctx.strokeRect(\n        Math.min(p1.x, p2.x),\n        Math.min(p1.y, p2.y),\n        Math.abs(p2.x - p1.x),\n        Math.abs(p2.y - p1.y)\n      );\n    }\n  };\n\n  const drawPolygonZone = (ctx, zone, zoneConfig, scaleX, scaleY) => {\n    const isPreviewZone = zone.isPreview === true;\n\n    // Scale points from natural to display coordinates (unless it's a preview)\n    const scaledPoints = zone.points.map(point => {\n      if (isPreviewZone) {\n        return point; // Already in display coordinates\n      } else {\n        return {\n          x: point.x * scaleX,\n          y: point.y * scaleY\n        };\n      }\n    });\n\n    // Draw polygon\n    ctx.save();\n    ctx.strokeStyle = zoneConfig.color;\n    ctx.fillStyle = zoneConfig.fillColor;\n    ctx.lineWidth = isPreviewZone ? 3 : 2;\n    ctx.setLineDash(isPreviewZone ? [5, 5] : []);\n\n    ctx.beginPath();\n    ctx.moveTo(scaledPoints[0].x, scaledPoints[0].y);\n\n    for (let i = 1; i < scaledPoints.length; i++) {\n      ctx.lineTo(scaledPoints[i].x, scaledPoints[i].y);\n    }\n\n    ctx.closePath();\n    ctx.fill();\n    ctx.stroke();\n\n    // Draw points\n    scaledPoints.forEach((point, index) => {\n      ctx.beginPath();\n      ctx.arc(point.x, point.y, 4, 0, 2 * Math.PI);\n      ctx.fillStyle = zoneConfig.color;\n      ctx.fill();\n      ctx.strokeStyle = '#fff';\n      ctx.lineWidth = 1;\n      ctx.stroke();\n    });\n\n    // Draw zone label\n    const centerX = scaledPoints.reduce((sum, p) => sum + p.x, 0) / scaledPoints.length;\n    const centerY = scaledPoints.reduce((sum, p) => sum + p.y, 0) / scaledPoints.length;\n\n    ctx.fillStyle = '#fff';\n    ctx.font = 'bold 12px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText(`${zoneConfig.icon} ${zone.name}`, centerX, centerY);\n\n    ctx.restore();\n  };\n\n  const drawPolygonPreview = (ctx, points, previewPoint, zoneConfig) => {\n    if (points.length === 0) return;\n\n    ctx.save();\n    ctx.strokeStyle = zoneConfig.color;\n    ctx.lineWidth = 3;\n    ctx.setLineDash([5, 5]);\n\n    // Draw lines between points\n    ctx.beginPath();\n    ctx.moveTo(points[0].x, points[0].y);\n\n    for (let i = 1; i < points.length; i++) {\n      ctx.lineTo(points[i].x, points[i].y);\n    }\n\n    // Draw preview line to mouse\n    if (previewPoint) {\n      ctx.lineTo(previewPoint.x, previewPoint.y);\n    }\n\n    ctx.stroke();\n\n    // Draw points\n    points.forEach((point, index) => {\n      ctx.beginPath();\n      ctx.arc(point.x, point.y, 6, 0, 2 * Math.PI);\n      ctx.fillStyle = zoneConfig.color;\n      ctx.fill();\n      ctx.strokeStyle = '#fff';\n      ctx.lineWidth = 2;\n      ctx.stroke();\n\n      // Draw point number\n      ctx.fillStyle = '#fff';\n      ctx.font = '10px Arial';\n      ctx.textAlign = 'center';\n      ctx.fillText((index + 1).toString(), point.x, point.y + 3);\n    });\n\n    ctx.restore();\n  };\n\n  const drawRectangleZone = (ctx, zone, zoneConfig, scaleX, scaleY) => {\n    const [p1, p2] = zone.points;\n\n    const isPreviewZone = zone.isPreview === true;\n\n    // Scale coordinates from natural to display (unless it's a preview)\n    let x1, y1, x2, y2;\n    if (isPreviewZone) {\n      x1 = p1.x;\n      y1 = p1.y;\n      x2 = p2.x;\n      y2 = p2.y;\n    } else {\n      x1 = p1.x * scaleX;\n      y1 = p1.y * scaleY;\n      x2 = p2.x * scaleX;\n      y2 = p2.y * scaleY;\n    }\n\n    const width = Math.abs(x2 - x1);\n    const height = Math.abs(y2 - y1);\n    const startX = Math.min(x1, x2);\n    const startY = Math.min(y1, y2);\n\n    // Draw rectangle\n    ctx.save();\n    ctx.fillStyle = zoneConfig.fillColor;\n    ctx.fillRect(startX, startY, width, height);\n\n    ctx.strokeStyle = zoneConfig.color;\n    ctx.lineWidth = isPreviewZone ? 3 : 2;\n    ctx.setLineDash(isPreviewZone ? [10, 5] : []);\n    ctx.strokeRect(startX, startY, width, height);\n\n    // Draw zone label\n    const labelX = startX + width / 2;\n    const labelY = startY + height / 2;\n\n    ctx.fillStyle = '#fff';\n    ctx.font = 'bold 14px Arial';\n    ctx.textAlign = 'center';\n    ctx.fillText(`${zoneConfig.icon} ${zone.name || zoneConfig.name}`, labelX, labelY);\n\n    // Draw requirement text\n    const reqText = zone.requiresScooper ? 'Scooper Required' : 'No Scooper Required';\n    ctx.font = '12px Arial';\n    ctx.fillStyle = zone.requiresScooper ? '#FF4757' : '#2ED573';\n    ctx.fillText(reqText, labelX, labelY + 18);\n\n    ctx.restore();\n  };\n\n  const deleteZone = (zoneId) => {\n    setZones(zones.filter(zone => zone.id !== zoneId));\n    setEditingZone(null);\n    toast.info('Zone deleted');\n  };\n\n  const clearAllZones = () => {\n    setZones([]);\n    setEditingZone(null);\n    toast.info('All zones cleared');\n  };\n\n  const exportZones = () => {\n    const exportData = {\n      zones: zones.map(zone => ({\n        ...zone,\n        // Convert to relative coordinates (0-1)\n        points: zone.points.map(p => ({\n          x: p.x / frameWidth,\n          y: p.y / frameHeight\n        }))\n      })),\n      frameSize: { width: frameWidth, height: frameHeight },\n      exportedAt: new Date().toISOString()\n    };\n    \n    const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `roi_zones_${Date.now()}.json`;\n    a.click();\n    URL.revokeObjectURL(url);\n    \n    toast.success('Zones exported successfully!');\n  }; // exportZones function closing\n\n  return (\n    <div style={{ width: '100%' }}>\n      {/* Zone Controls - Only show in editing mode */}\n      {isEnabled && (\n        <div style={{\n          marginBottom: '16px',\n          padding: '16px',\n          background: 'rgba(255,255,255,0.1)',\n          borderRadius: '8px'\n        }}>\n        <h4 style={{ margin: '0 0 12px 0', color: '#fff' }}>ðŸŽ¯ ROI Zone Manager</h4>\n        \n        {/* Zone Type Selector */}\n        <div style={{ marginBottom: '12px' }}>\n          <label style={{ display: 'block', marginBottom: '6px', fontWeight: 'bold' }}>\n            Zone Type:\n          </label>\n          <select\n            value={selectedZoneType}\n            onChange={(e) => setSelectedZoneType(e.target.value)}\n            style={{\n              padding: '8px',\n              borderRadius: '6px',\n              border: '1px solid rgba(255,255,255,0.3)',\n              background: 'rgba(255,255,255,0.1)',\n              color: 'white',\n              width: '200px'\n            }}\n          >\n            {Object.entries(zoneTypes).map(([key, config]) => (\n              <option key={key} value={key} style={{ background: '#333', color: 'white' }}>\n                {config.icon} {config.name}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Drawing Mode Selector */}\n        <div style={{ marginBottom: '12px' }}>\n          <label style={{ display: 'block', marginBottom: '6px', fontWeight: 'bold' }}>\n            Drawing Mode:\n          </label>\n          <div style={{ display: 'flex', gap: '8px' }}>\n            <button\n              onClick={() => setDrawingMode('rectangle')}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '6px',\n                border: drawingMode === 'rectangle' ? '2px solid #00FF88' : '1px solid rgba(255,255,255,0.3)',\n                background: drawingMode === 'rectangle' ? 'rgba(0,255,136,0.2)' : 'rgba(255,255,255,0.1)',\n                color: drawingMode === 'rectangle' ? '#00FF88' : '#fff',\n                cursor: 'pointer',\n                fontSize: '12px'\n              }}\n            >\n              ðŸ“¦ Rectangle\n            </button>\n            <button\n              onClick={() => setDrawingMode('polygon')}\n              style={{\n                padding: '8px 12px',\n                borderRadius: '6px',\n                border: drawingMode === 'polygon' ? '2px solid #FF6B35' : '1px solid rgba(255,255,255,0.3)',\n                background: drawingMode === 'polygon' ? 'rgba(255,107,53,0.2)' : 'rgba(255,255,255,0.1)',\n                color: drawingMode === 'polygon' ? '#FF6B35' : '#fff',\n                cursor: 'pointer',\n                fontSize: '12px'\n              }}\n            >\n              ðŸ”º Polygon\n            </button>\n          </div>\n          <div style={{ fontSize: '11px', color: '#ccc', marginTop: '4px' }}>\n            {drawingMode === 'rectangle' ?\n              'ðŸ“¦ Click and drag to create rectangular zones' :\n              'ðŸ”º Click points to create polygon zones (perfect for sauce areas)'\n            }\n          </div>\n          {zoneTypes[selectedZoneType]?.preferredShape && (\n            <div style={{\n              fontSize: '11px',\n              color: zoneTypes[selectedZoneType].preferredShape === 'polygon' ? '#FF6B35' : '#FFD23F',\n              marginTop: '2px',\n              fontStyle: 'italic'\n            }}>\n              ðŸ’¡ Recommended: {zoneTypes[selectedZoneType].preferredShape} for {zoneTypes[selectedZoneType].name}\n            </div>\n          )}\n        </div>\n\n        {/* Drawing Status */}\n        <div style={{\n          padding: '8px 12px',\n          background: isEnabled ? 'rgba(0,255,136,0.2)' : 'rgba(255,255,255,0.1)',\n          borderRadius: '6px',\n          marginBottom: '12px',\n          border: `2px solid ${isEnabled ? '#00FF88' : 'rgba(255,255,255,0.3)'}`\n        }}>\n          <span style={{ color: isEnabled ? '#00FF88' : '#fff' }}>\n            {isEnabled ?\n              (drawingMode === 'polygon' ?\n                'ðŸ”º Polygon Mode: ACTIVE - Click points to create polygon zones' :\n                'ðŸ“¦ Rectangle Mode: ACTIVE - Click and drag to create zones'\n              ) :\n              'ðŸ”’ Drawing Mode: DISABLED'\n            }\n          </span>\n          <div style={{ fontSize: '12px', marginTop: '4px', opacity: 0.8 }}>\n            Debug: isEnabled={isEnabled.toString()}, currentFrame={!!currentFrame ? 'available' : 'none'},\n            frameSize={frameWidth}x{frameHeight}\n          </div>\n        </div>\n\n        {/* Polygon Drawing Controls */}\n        {drawingMode === 'polygon' && (\n          <div style={{\n            padding: '8px 12px',\n            background: 'rgba(255,107,53,0.2)',\n            borderRadius: '6px',\n            marginBottom: '12px',\n            border: '2px solid #FF6B35'\n          }}>\n            <div style={{ color: '#FF6B35', fontWeight: 'bold', marginBottom: '8px' }}>\n              ðŸ”º Polygon Drawing Status\n            </div>\n            <div style={{ fontSize: '12px', color: '#fff', marginBottom: '8px' }}>\n              {polygonPoints.length === 0 && 'Click to start drawing polygon'}\n              {polygonPoints.length > 0 && polygonPoints.length < 3 &&\n                `${polygonPoints.length} points added. Need ${3 - polygonPoints.length} more.`}\n              {polygonPoints.length >= 3 &&\n                `${polygonPoints.length} points. Click near first point to close polygon.`}\n            </div>\n            {polygonPoints.length > 0 && (\n              <div style={{ display: 'flex', gap: '6px' }}>\n                <button\n                  onClick={() => {\n                    if (polygonPoints.length > 0) {\n                      const newPoints = polygonPoints.slice(0, -1);\n                      setPolygonPoints(newPoints);\n                      if (newPoints.length === 0) {\n                        setIsDrawing(false);\n                        setPreviewPoint(null);\n                      }\n                      toast.info('Last point removed');\n                    }\n                  }}\n                  style={{\n                    padding: '4px 8px',\n                    background: '#FF9800',\n                    color: '#fff',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'pointer',\n                    fontSize: '11px'\n                  }}\n                >\n                  â†¶ Undo Point\n                </button>\n                <button\n                  onClick={() => {\n                    setPolygonPoints([]);\n                    setIsDrawing(false);\n                    setPreviewPoint(null);\n                    toast.info('Polygon cleared');\n                  }}\n                  style={{\n                    padding: '4px 8px',\n                    background: '#f44336',\n                    color: '#fff',\n                    border: 'none',\n                    borderRadius: '4px',\n                    cursor: 'pointer',\n                    fontSize: '11px'\n                  }}\n                >\n                  ðŸ—‘ï¸ Clear\n                </button>\n                {polygonPoints.length >= 3 && (\n                  <button\n                    onClick={completePolygon}\n                    style={{\n                      padding: '4px 8px',\n                      background: '#4CAF50',\n                      color: '#fff',\n                      border: 'none',\n                      borderRadius: '4px',\n                      cursor: 'pointer',\n                      fontSize: '11px'\n                    }}\n                  >\n                    âœ… Complete\n                  </button>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Controls */}\n        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap', alignItems: 'center' }}>\n          <button\n            className=\"btn btn-primary\"\n            onClick={() => setShowZones(!showZones)}\n          >\n            {showZones ? 'ðŸ‘ï¸ Hide Zones' : 'ðŸ‘ï¸â€ðŸ—¨ï¸ Show Zones'}\n          </button>\n          \n          <button\n            className=\"btn btn-warning\"\n            onClick={clearAllZones}\n            disabled={zones.length === 0}\n          >\n            ðŸ—‘ï¸ Clear All\n          </button>\n          \n          <button\n            className=\"btn btn-success\"\n            onClick={exportZones}\n            disabled={zones.length === 0}\n          >\n            ðŸ“¥ Export Zones\n          </button>\n\n          <button\n            className=\"btn btn-info\"\n            onClick={() => {\n              // Add a test zone to verify functionality\n              const testZone = {\n                id: `test_zone_${Date.now()}`,\n                type: selectedZoneType,\n                points: [\n                  { x: 50, y: 50 },\n                  { x: 200, y: 150 }\n                ],\n                isComplete: true,\n                name: `Test ${zoneTypes[selectedZoneType].name}`,\n                requiresScooper: zoneTypes[selectedZoneType].requiresScooper\n              };\n              setZones([...zones, testZone]);\n              toast.success('Test zone added!');\n            }}\n          >\n            ðŸ§ª Add Test Zone\n          </button>\n          \n          <span style={{ marginLeft: '16px', fontSize: '14px', opacity: 0.8 }}>\n            Zones: {zones.length} | {isEnabled ? 'Click and drag to create zones' : 'Enable drawing to create zones'}\n          </span>\n        </div>\n\n        {/* Drawing Instructions */}\n        {isEnabled && zones.length === 0 && (\n          <div style={{\n            padding: '12px',\n            background: 'rgba(255,210,63,0.2)',\n            borderRadius: '6px',\n            marginTop: '8px',\n            border: '2px dashed #FFD23F'\n          }}>\n            <div style={{ color: '#FFD23F', fontWeight: 'bold', marginBottom: '4px' }}>\n              ðŸ“ How to Draw Zones:\n            </div>\n            <div style={{ fontSize: '14px', opacity: 0.9 }}>\n              1. Select zone type above (e.g., \"ðŸ… Sauce Area\")<br />\n              2. Click and hold on the video to start drawing<br />\n              3. Drag to create a rectangle<br />\n              4. Release to complete the zone\n            </div>\n          </div>\n        )}\n\n        {isDrawing && (\n          <div style={{\n            padding: '8px 12px',\n            background: 'rgba(0,212,255,0.3)',\n            borderRadius: '6px',\n            marginTop: '8px',\n            textAlign: 'center',\n            border: '2px solid #00D4FF'\n          }}>\n            <span style={{ color: '#00D4FF', fontWeight: 'bold' }}>\n              ðŸŽ¨ Drawing in progress... Drag to set zone size\n            </span>\n          </div>\n        )}\n        </div>\n      )}\n\n      {/* Video with zone drawing overlay */}\n      <div style={{\n        position: 'relative',\n        display: 'inline-block',\n        width: '100%',\n        maxWidth: '100%',\n        background: '#000',\n        borderRadius: '8px',\n        overflow: 'hidden'\n      }}>\n        {/* Background video frame */}\n        {currentFrame && (\n          <img\n            id=\"roi-background-image\"\n            src={`data:image/jpeg;base64,${currentFrame}`}\n            alt=\"Video frame for zone configuration\"\n            style={{\n              width: '100%',\n              height: 'auto',\n              display: 'block',\n              borderRadius: '8px'\n            }}\n            onLoad={(e) => {\n              console.log('ðŸŽ¯ ROI Manager: Video frame loaded');\n              const img = e.target;\n              const rect = img.getBoundingClientRect();\n              console.log('ðŸ“ Image dimensions:', {\n                natural: `${img.naturalWidth}x${img.naturalHeight}`,\n                display: `${rect.width}x${rect.height}`\n              });\n\n              // Update canvas size to match image\n              const canvas = canvasRef.current;\n              if (canvas) {\n                canvas.width = rect.width;\n                canvas.height = rect.height;\n                canvas.style.width = rect.width + 'px';\n                canvas.style.height = rect.height + 'px';\n                console.log('ðŸŽ¨ Canvas resized to match image');\n              }\n\n              setTimeout(() => drawZones(), 100);\n            }}\n          />\n        )}\n\n        {/* Zone drawing canvas overlay */}\n        <canvas\n          ref={canvasRef}\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            cursor: isEnabled ? 'crosshair' : 'default',\n            pointerEvents: isEnabled ? 'auto' : 'none',\n            zIndex: 20,\n            borderRadius: '8px'\n          }}\n          onMouseDown={handleMouseDown}\n          onMouseMove={handleMouseMove}\n          onMouseUp={handleMouseUp}\n          onContextMenu={(e) => e.preventDefault()}\n        />\n\n        {!currentFrame && (\n          <div style={{\n            width: '100%',\n            height: '300px',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            background: 'rgba(255,255,255,0.1)',\n            color: 'rgba(255,255,255,0.6)'\n          }}>\n            <div style={{ textAlign: 'center' }}>\n              <div style={{ fontSize: '48px', marginBottom: '16px' }}>ðŸŽ¥</div>\n              <p>Video frame will appear here</p>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Zone List - Only show in editing mode */}\n      {isEnabled && zones.length > 0 && (\n        <div style={{\n          marginTop: '16px',\n          padding: '16px',\n          background: 'rgba(255,255,255,0.05)',\n          borderRadius: '8px'\n        }}>\n          <h4 style={{ margin: '0 0 12px 0' }}>ðŸ“‹ Active Zones ({zones.length})</h4>\n          <div style={{ maxHeight: '200px', overflowY: 'auto' }}>\n            {zones.map((zone, index) => {\n              const config = zoneTypes[zone.type];\n              return (\n                <div\n                  key={zone.id}\n                  style={{\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    padding: '8px 12px',\n                    marginBottom: '8px',\n                    background: editingZone?.id === zone.id ? 'rgba(255,255,255,0.2)' : 'rgba(255,255,255,0.1)',\n                    borderRadius: '6px',\n                    border: `2px solid ${config.color}`\n                  }}\n                >\n                  <div>\n                    <strong>{config.icon} {zone.name}</strong>\n                    <br />\n                    <small style={{ opacity: 0.8 }}>\n                      {config.description} | Scooper: {zone.requiresScooper ? 'ðŸ¥„ Required' : 'ðŸš« Not Required'}\n                    </small>\n                  </div>\n                  <button\n                    onClick={() => deleteZone(zone.id)}\n                    style={{\n                      background: '#FF4757',\n                      border: 'none',\n                      borderRadius: '4px',\n                      padding: '4px 8px',\n                      color: 'white',\n                      cursor: 'pointer',\n                      fontSize: '12px'\n                    }}\n                  >\n                    ðŸ—‘ï¸ Delete\n                  </button>\n                </div>\n              );\n            })}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n} // Missing closing brace added\n}; // Main component closing brace\n\nexport default ROIZoneManager;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}