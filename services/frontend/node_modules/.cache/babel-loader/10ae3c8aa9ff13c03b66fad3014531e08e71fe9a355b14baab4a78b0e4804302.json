{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ayoub\\\\OneDrive\\\\Desktop\\\\eagleAI\\\\pizza_store_detection\\\\services\\\\frontend\\\\src\\\\components\\\\ViolationDetector.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { toast } from 'react-toastify';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ViolationDetector = ({\n  detections = [],\n  zones = [],\n  frameWidth = 640,\n  frameHeight = 480,\n  onViolationDetected\n}) => {\n  _s();\n  const [violations, setViolations] = useState([]);\n  const [violationHistory, setViolationHistory] = useState([]);\n  const [settings, setSettings] = useState({\n    enabled: true,\n    sensitivity: 0.7,\n    // Confidence threshold for violations\n    temporalWindow: 3,\n    // Seconds to track violations\n    movementThreshold: 20 // Pixels of movement to consider \"handling\"\n  });\n  const violationCanvasRef = useRef(null);\n  const handTrackingRef = useRef(new Map()); // Track hand positions over time\n\n  // Violation types with professional configuration\n  const violationTypes = {\n    HAND_IN_INGREDIENT_NO_SCOOPER: {\n      severity: 'high',\n      color: '#FF3333',\n      icon: 'ðŸš¨',\n      title: 'Hand Contact Without Scooper',\n      description: 'Hand detected in ingredient area without scooper present'\n    },\n    CROSS_CONTAMINATION: {\n      severity: 'high',\n      color: '#FF6B35',\n      icon: 'âš ï¸',\n      title: 'Cross Contamination Risk',\n      description: 'Hand moved between different ingredient areas without cleaning'\n    },\n    IMPROPER_TOOL_USE: {\n      severity: 'medium',\n      color: '#FFD23F',\n      icon: 'ðŸ¥„',\n      title: 'Improper Tool Usage',\n      description: 'Scooper used incorrectly or in wrong area'\n    },\n    EXTENDED_CONTACT: {\n      severity: 'medium',\n      color: '#FF8C42',\n      icon: 'â±ï¸',\n      title: 'Extended Hand Contact',\n      description: 'Hand in ingredient area for extended period'\n    }\n  };\n  useEffect(() => {\n    console.log('ðŸš¨ ViolationDetector useEffect:', {\n      enabled: settings.enabled,\n      detections: detections.length,\n      zones: zones.length,\n      frameSize: `${frameWidth}x${frameHeight}`\n    });\n    if (settings.enabled && detections.length > 0 && zones.length > 0) {\n      console.log('ðŸ” Starting violation analysis...');\n      analyzeViolations();\n    } else {\n      console.log('â¸ï¸ Violation analysis skipped:', {\n        enabled: settings.enabled,\n        hasDetections: detections.length > 0,\n        hasZones: zones.length > 0\n      });\n    }\n  }, [detections, zones, settings.enabled]);\n  useEffect(() => {\n    drawViolationOverlay();\n  }, [violations, frameWidth, frameHeight]);\n  const analyzeViolations = () => {\n    const currentTime = Date.now();\n    const newViolations = [];\n\n    // Get current hands and scoopers\n    const hands = detections.filter(d => d.class_name === 'hand');\n    const scoopers = detections.filter(d => d.class_name === 'scooper');\n    const persons = detections.filter(d => d.class_name === 'person');\n    console.log('ðŸ” Analyzing violations:', {\n      hands: hands.length,\n      scoopers: scoopers.length,\n      persons: persons.length,\n      zones: zones.length\n    });\n\n    // Analyze each hand\n    hands.forEach((hand, handIndex) => {\n      const handId = `hand_${handIndex}`;\n      const handCenter = {\n        x: (hand.bbox.x1 + hand.bbox.x2) / 2,\n        y: (hand.bbox.y1 + hand.bbox.y2) / 2\n      };\n\n      // Update hand tracking\n      if (!handTrackingRef.current.has(handId)) {\n        handTrackingRef.current.set(handId, {\n          positions: [],\n          lastZone: null,\n          firstDetected: currentTime\n        });\n      }\n      const handTracking = handTrackingRef.current.get(handId);\n      handTracking.positions.push({\n        ...handCenter,\n        timestamp: currentTime,\n        confidence: hand.confidence\n      });\n\n      // Keep only recent positions (temporal window)\n      const windowMs = settings.temporalWindow * 1000;\n      handTracking.positions = handTracking.positions.filter(pos => currentTime - pos.timestamp < windowMs);\n\n      // Check which zone the hand is in\n      const currentZone = findZoneContainingPoint(handCenter.x, handCenter.y);\n      if (currentZone && currentZone.requiresScooper) {\n        // Check for scooper presence near this hand\n        const nearbyScoopers = scoopers.filter(scooper => {\n          const scooperCenter = {\n            x: (scooper.bbox.x1 + scooper.bbox.x2) / 2,\n            y: (scooper.bbox.y1 + scooper.bbox.y2) / 2\n          };\n          const distance = Math.sqrt(Math.pow(handCenter.x - scooperCenter.x, 2) + Math.pow(handCenter.y - scooperCenter.y, 2));\n          return distance < 100; // Within 100 pixels\n        });\n\n        // Check for movement (indicates handling, not just cleaning)\n        const isHandling = checkHandMovement(handTracking.positions);\n\n        // VIOLATION: Hand in ingredient area without scooper\n        if (nearbyScoopers.length === 0 && isHandling) {\n          const violation = createViolation('HAND_IN_INGREDIENT_NO_SCOOPER', {\n            handId,\n            hand,\n            zone: currentZone,\n            confidence: hand.confidence,\n            position: handCenter,\n            duration: (currentTime - handTracking.firstDetected) / 1000\n          });\n          newViolations.push(violation);\n        }\n\n        // VIOLATION: Cross contamination check\n        if (handTracking.lastZone && handTracking.lastZone.id !== currentZone.id && handTracking.lastZone.requiresScooper) {\n          const violation = createViolation('CROSS_CONTAMINATION', {\n            handId,\n            hand,\n            fromZone: handTracking.lastZone,\n            toZone: currentZone,\n            confidence: hand.confidence * 0.8,\n            // Slightly lower confidence\n            position: handCenter\n          });\n          newViolations.push(violation);\n        }\n\n        // VIOLATION: Extended contact\n        const contactDuration = (currentTime - handTracking.firstDetected) / 1000;\n        if (contactDuration > 5 && nearbyScoopers.length === 0) {\n          // 5 seconds\n          const violation = createViolation('EXTENDED_CONTACT', {\n            handId,\n            hand,\n            zone: currentZone,\n            confidence: Math.min(hand.confidence + 0.1, 1.0),\n            position: handCenter,\n            duration: contactDuration\n          });\n          newViolations.push(violation);\n        }\n        handTracking.lastZone = currentZone;\n      }\n    });\n\n    // Clean up old hand tracking data\n    const activeHandIds = hands.map((_, index) => `hand_${index}`);\n    for (const [handId, tracking] of handTrackingRef.current.entries()) {\n      var _tracking$positions;\n      if (!activeHandIds.includes(handId) && currentTime - ((_tracking$positions = tracking.positions[tracking.positions.length - 1]) === null || _tracking$positions === void 0 ? void 0 : _tracking$positions.timestamp) > 2000) {\n        handTrackingRef.current.delete(handId);\n      }\n    }\n\n    // Update violations\n    if (newViolations.length > 0) {\n      setViolations(newViolations);\n      setViolationHistory(prev => [...prev, ...newViolations].slice(-50)); // Keep last 50\n\n      // Notify parent component and show toasts\n      newViolations.forEach(violation => {\n        if (onViolationDetected) {\n          onViolationDetected(violation);\n        }\n        const config = violationTypes[violation.type];\n        toast.error(`${config.icon} ${config.title}`, {\n          position: \"top-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true\n        });\n      });\n    } else {\n      setViolations([]);\n    }\n  };\n  const findZoneContainingPoint = (x, y) => {\n    // x, y are detection coordinates (natural frame coordinates)\n    // zones are stored in natural frame coordinates\n    const foundZone = zones.find(zone => {\n      if (zone.points && zone.points.length >= 2) {\n        const [p1, p2] = zone.points;\n        const inZone = x >= Math.min(p1.x, p2.x) && x <= Math.max(p1.x, p2.x) && y >= Math.min(p1.y, p2.y) && y <= Math.max(p1.y, p2.y);\n        if (inZone) {\n          console.log(`ðŸŽ¯ Point (${x.toFixed(1)}, ${y.toFixed(1)}) is in zone ${zone.name}:`, {\n            point: {\n              x,\n              y\n            },\n            zone: {\n              p1,\n              p2\n            },\n            zoneName: zone.name\n          });\n        }\n        return inZone;\n      }\n      return false;\n    });\n    return foundZone;\n  };\n  const checkHandMovement = positions => {\n    if (positions.length < 2) return false;\n    let totalMovement = 0;\n    for (let i = 1; i < positions.length; i++) {\n      const distance = Math.sqrt(Math.pow(positions[i].x - positions[i - 1].x, 2) + Math.pow(positions[i].y - positions[i - 1].y, 2));\n      totalMovement += distance;\n    }\n    return totalMovement > settings.movementThreshold;\n  };\n  const createViolation = (type, data) => {\n    return {\n      id: `violation_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      timestamp: new Date().toISOString(),\n      severity: violationTypes[type].severity,\n      confidence: data.confidence,\n      description: violationTypes[type].description,\n      details: data,\n      resolved: false\n    };\n  };\n  const drawViolationOverlay = () => {\n    const canvas = violationCanvasRef.current;\n    if (!canvas || violations.length === 0) return;\n    const ctx = canvas.getContext('2d');\n\n    // Get the video element to match its display size\n    const videoElement = document.querySelector('img[alt=\"Current frame\"]');\n    if (videoElement) {\n      const rect = videoElement.getBoundingClientRect();\n      canvas.width = rect.width;\n      canvas.height = rect.height;\n      canvas.style.width = rect.width + 'px';\n      canvas.style.height = rect.height + 'px';\n    } else {\n      canvas.width = frameWidth;\n      canvas.height = frameHeight;\n    }\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // Calculate scaling from natural to display coordinates\n    const naturalWidth = frameWidth;\n    const naturalHeight = frameHeight;\n    const displayWidth = canvas.width;\n    const displayHeight = canvas.height;\n    const scaleX = displayWidth / naturalWidth;\n    const scaleY = displayHeight / naturalHeight;\n    console.log('ðŸš¨ Drawing violations:', {\n      violations: violations.length,\n      naturalSize: `${naturalWidth}x${naturalHeight}`,\n      displaySize: `${displayWidth}x${displayHeight}`,\n      scale: `${scaleX.toFixed(3)}x${scaleY.toFixed(3)}`\n    });\n\n    // Draw violation indicators\n    violations.forEach((violation, index) => {\n      const config = violationTypes[violation.type];\n      const position = violation.details.position;\n      if (position) {\n        // Scale position from natural to display coordinates\n        const displayX = position.x * scaleX;\n        const displayY = position.y * scaleY;\n\n        // Pulsing violation indicator\n        const pulseScale = 1 + 0.3 * Math.sin(Date.now() / 200);\n        const radius = 30 * pulseScale;\n\n        // Outer glow\n        ctx.beginPath();\n        ctx.arc(displayX, displayY, radius + 10, 0, 2 * Math.PI);\n        ctx.fillStyle = config.color + '40'; // 25% opacity\n        ctx.fill();\n\n        // Main circle\n        ctx.beginPath();\n        ctx.arc(displayX, displayY, radius, 0, 2 * Math.PI);\n        ctx.fillStyle = config.color + 'AA'; // 67% opacity\n        ctx.fill();\n        ctx.strokeStyle = config.color;\n        ctx.lineWidth = 3;\n        ctx.stroke();\n\n        // Icon\n        ctx.fillStyle = '#FFFFFF';\n        ctx.font = 'bold 20px Arial';\n        ctx.textAlign = 'center';\n        ctx.fillText(config.icon, displayX, displayY + 7);\n\n        // Violation type label\n        ctx.fillStyle = config.color;\n        ctx.font = 'bold 12px Arial';\n        ctx.fillText(violation.type.replace(/_/g, ' '), displayX, displayY - radius - 10);\n        console.log(`ðŸš¨ Drew violation at:`, {\n          natural: `(${position.x.toFixed(1)}, ${position.y.toFixed(1)})`,\n          display: `(${displayX.toFixed(1)}, ${displayY.toFixed(1)})`,\n          type: violation.type\n        });\n      }\n    });\n  };\n  const getViolationStats = () => {\n    const now = new Date();\n    const last24h = violationHistory.filter(v => {\n      const violationTime = new Date(v.timestamp);\n      const hoursDiff = (now - violationTime) / (1000 * 60 * 60);\n      return hoursDiff < 24;\n    });\n    const byType = {};\n    last24h.forEach(v => {\n      byType[v.type] = (byType[v.type] || 0) + 1;\n    });\n    return {\n      total: violationHistory.length,\n      last24h: last24h.length,\n      current: violations.length,\n      byType\n    };\n  };\n  const stats = getViolationStats();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: '100%',\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: violationCanvasRef,\n      style: {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        zIndex: 30,\n        borderRadius: '8px'\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 399,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        marginTop: '16px',\n        padding: '16px',\n        background: 'rgba(255,255,255,0.1)',\n        borderRadius: '8px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        style: {\n          margin: '0 0 12px 0',\n          color: '#fff'\n        },\n        children: \"\\uD83D\\uDEA8 Violation Detection\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 418,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: '16px',\n          marginBottom: '12px',\n          flexWrap: 'wrap'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: settings.enabled,\n            onChange: e => setSettings({\n              ...settings,\n              enabled: e.target.checked\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Enable Detection\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 428,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            gap: '8px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Sensitivity:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 432,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"range\",\n            min: \"0.1\",\n            max: \"1.0\",\n            step: \"0.1\",\n            value: settings.sensitivity,\n            onChange: e => setSettings({\n              ...settings,\n              sensitivity: parseFloat(e.target.value)\n            }),\n            style: {\n              width: '100px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 433,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: settings.sensitivity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'grid',\n          gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))',\n          gap: '12px',\n          marginBottom: '12px'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'center',\n            padding: '8px',\n            background: 'rgba(255,255,255,0.1)',\n            borderRadius: '6px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '24px',\n              fontWeight: 'bold',\n              color: '#FF3333'\n            },\n            children: stats.current\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 454,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              opacity: 0.8\n            },\n            children: \"Active Violations\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'center',\n            padding: '8px',\n            background: 'rgba(255,255,255,0.1)',\n            borderRadius: '6px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '24px',\n              fontWeight: 'bold',\n              color: '#FFD23F'\n            },\n            children: stats.last24h\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 458,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              opacity: 0.8\n            },\n            children: \"Last 24 Hours\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 459,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 457,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            textAlign: 'center',\n            padding: '8px',\n            background: 'rgba(255,255,255,0.1)',\n            borderRadius: '6px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '24px',\n              fontWeight: 'bold',\n              color: '#2ED573'\n            },\n            children: stats.total\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 462,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: '12px',\n              opacity: 0.8\n            },\n            children: \"Total Detected\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 463,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 461,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 447,\n        columnNumber: 9\n      }, this), violations.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: '12px',\n          background: 'rgba(255, 51, 51, 0.2)',\n          borderRadius: '6px',\n          border: '2px solid #FF3333'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n          style: {\n            margin: '0 0 8px 0',\n            color: '#FF3333'\n          },\n          children: \"\\uD83D\\uDEA8 Active Violations\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 13\n        }, this), violations.map((violation, index) => {\n          const config = violationTypes[violation.type];\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              marginBottom: '8px',\n              padding: '8px',\n              background: 'rgba(255,255,255,0.1)',\n              borderRadius: '4px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                display: 'flex',\n                justifyContent: 'space-between',\n                alignItems: 'center'\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                style: {\n                  color: config.color\n                },\n                children: [config.icon, \" \", config.title]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 486,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: {\n                  background: config.color,\n                  color: 'white',\n                  padding: '2px 6px',\n                  borderRadius: '4px',\n                  fontSize: '12px'\n                },\n                children: violation.severity.toUpperCase()\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 489,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 485,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '14px',\n                opacity: 0.9,\n                marginTop: '4px'\n              },\n              children: config.description\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 499,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                fontSize: '12px',\n                opacity: 0.7,\n                marginTop: '4px'\n              },\n              children: [\"Confidence: \", (violation.confidence * 100).toFixed(1), \"% | Time: \", new Date(violation.timestamp).toLocaleTimeString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 502,\n              columnNumber: 19\n            }, this)]\n          }, violation.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 479,\n            columnNumber: 17\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 469,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 412,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 397,\n    columnNumber: 5\n  }, this);\n};\n_s(ViolationDetector, \"9C/pPEmd9tcohTjk2MuwT7WWdGU=\");\n_c = ViolationDetector;\nexport default ViolationDetector;\nvar _c;\n$RefreshReg$(_c, \"ViolationDetector\");","map":{"version":3,"names":["React","useState","useEffect","useRef","toast","jsxDEV","_jsxDEV","ViolationDetector","detections","zones","frameWidth","frameHeight","onViolationDetected","_s","violations","setViolations","violationHistory","setViolationHistory","settings","setSettings","enabled","sensitivity","temporalWindow","movementThreshold","violationCanvasRef","handTrackingRef","Map","violationTypes","HAND_IN_INGREDIENT_NO_SCOOPER","severity","color","icon","title","description","CROSS_CONTAMINATION","IMPROPER_TOOL_USE","EXTENDED_CONTACT","console","log","length","frameSize","analyzeViolations","hasDetections","hasZones","drawViolationOverlay","currentTime","Date","now","newViolations","hands","filter","d","class_name","scoopers","persons","forEach","hand","handIndex","handId","handCenter","x","bbox","x1","x2","y","y1","y2","current","has","set","positions","lastZone","firstDetected","handTracking","get","push","timestamp","confidence","windowMs","pos","currentZone","findZoneContainingPoint","requiresScooper","nearbyScoopers","scooper","scooperCenter","distance","Math","sqrt","pow","isHandling","checkHandMovement","violation","createViolation","zone","position","duration","id","fromZone","toZone","contactDuration","min","activeHandIds","map","_","index","tracking","entries","_tracking$positions","includes","delete","prev","slice","config","type","error","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","foundZone","find","points","p1","p2","inZone","max","toFixed","name","point","zoneName","totalMovement","i","data","random","toString","substr","toISOString","details","resolved","canvas","ctx","getContext","videoElement","document","querySelector","rect","getBoundingClientRect","width","height","style","clearRect","naturalWidth","naturalHeight","displayWidth","displayHeight","scaleX","scaleY","naturalSize","displaySize","scale","displayX","displayY","pulseScale","sin","radius","beginPath","arc","PI","fillStyle","fill","strokeStyle","lineWidth","stroke","font","textAlign","fillText","replace","natural","display","getViolationStats","last24h","v","violationTime","hoursDiff","byType","total","stats","children","ref","top","left","pointerEvents","zIndex","borderRadius","fileName","_jsxFileName","lineNumber","columnNumber","marginTop","padding","background","margin","gap","marginBottom","flexWrap","alignItems","checked","onChange","e","target","step","value","parseFloat","gridTemplateColumns","fontSize","fontWeight","opacity","border","justifyContent","toUpperCase","toLocaleTimeString","_c","$RefreshReg$"],"sources":["C:/Users/ayoub/OneDrive/Desktop/eagleAI/pizza_store_detection/services/frontend/src/components/ViolationDetector.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { toast } from 'react-toastify';\n\nconst ViolationDetector = ({ \n  detections = [], \n  zones = [], \n  frameWidth = 640, \n  frameHeight = 480,\n  onViolationDetected \n}) => {\n  const [violations, setViolations] = useState([]);\n  const [violationHistory, setViolationHistory] = useState([]);\n  const [settings, setSettings] = useState({\n    enabled: true,\n    sensitivity: 0.7, // Confidence threshold for violations\n    temporalWindow: 3, // Seconds to track violations\n    movementThreshold: 20, // Pixels of movement to consider \"handling\"\n  });\n  \n  const violationCanvasRef = useRef(null);\n  const handTrackingRef = useRef(new Map()); // Track hand positions over time\n\n  // Violation types with professional configuration\n  const violationTypes = {\n    HAND_IN_INGREDIENT_NO_SCOOPER: {\n      severity: 'high',\n      color: '#FF3333',\n      icon: 'ðŸš¨',\n      title: 'Hand Contact Without Scooper',\n      description: 'Hand detected in ingredient area without scooper present'\n    },\n    CROSS_CONTAMINATION: {\n      severity: 'high', \n      color: '#FF6B35',\n      icon: 'âš ï¸',\n      title: 'Cross Contamination Risk',\n      description: 'Hand moved between different ingredient areas without cleaning'\n    },\n    IMPROPER_TOOL_USE: {\n      severity: 'medium',\n      color: '#FFD23F',\n      icon: 'ðŸ¥„',\n      title: 'Improper Tool Usage',\n      description: 'Scooper used incorrectly or in wrong area'\n    },\n    EXTENDED_CONTACT: {\n      severity: 'medium',\n      color: '#FF8C42',\n      icon: 'â±ï¸',\n      title: 'Extended Hand Contact',\n      description: 'Hand in ingredient area for extended period'\n    }\n  };\n\n  useEffect(() => {\n    console.log('ðŸš¨ ViolationDetector useEffect:', {\n      enabled: settings.enabled,\n      detections: detections.length,\n      zones: zones.length,\n      frameSize: `${frameWidth}x${frameHeight}`\n    });\n\n    if (settings.enabled && detections.length > 0 && zones.length > 0) {\n      console.log('ðŸ” Starting violation analysis...');\n      analyzeViolations();\n    } else {\n      console.log('â¸ï¸ Violation analysis skipped:', {\n        enabled: settings.enabled,\n        hasDetections: detections.length > 0,\n        hasZones: zones.length > 0\n      });\n    }\n  }, [detections, zones, settings.enabled]);\n\n  useEffect(() => {\n    drawViolationOverlay();\n  }, [violations, frameWidth, frameHeight]);\n\n  const analyzeViolations = () => {\n    const currentTime = Date.now();\n    const newViolations = [];\n\n    // Get current hands and scoopers\n    const hands = detections.filter(d => d.class_name === 'hand');\n    const scoopers = detections.filter(d => d.class_name === 'scooper');\n    const persons = detections.filter(d => d.class_name === 'person');\n\n    console.log('ðŸ” Analyzing violations:', {\n      hands: hands.length,\n      scoopers: scoopers.length,\n      persons: persons.length,\n      zones: zones.length\n    });\n\n    // Analyze each hand\n    hands.forEach((hand, handIndex) => {\n      const handId = `hand_${handIndex}`;\n      const handCenter = {\n        x: (hand.bbox.x1 + hand.bbox.x2) / 2,\n        y: (hand.bbox.y1 + hand.bbox.y2) / 2\n      };\n\n      // Update hand tracking\n      if (!handTrackingRef.current.has(handId)) {\n        handTrackingRef.current.set(handId, {\n          positions: [],\n          lastZone: null,\n          firstDetected: currentTime\n        });\n      }\n\n      const handTracking = handTrackingRef.current.get(handId);\n      handTracking.positions.push({\n        ...handCenter,\n        timestamp: currentTime,\n        confidence: hand.confidence\n      });\n\n      // Keep only recent positions (temporal window)\n      const windowMs = settings.temporalWindow * 1000;\n      handTracking.positions = handTracking.positions.filter(\n        pos => currentTime - pos.timestamp < windowMs\n      );\n\n      // Check which zone the hand is in\n      const currentZone = findZoneContainingPoint(handCenter.x, handCenter.y);\n      \n      if (currentZone && currentZone.requiresScooper) {\n        // Check for scooper presence near this hand\n        const nearbyScoopers = scoopers.filter(scooper => {\n          const scooperCenter = {\n            x: (scooper.bbox.x1 + scooper.bbox.x2) / 2,\n            y: (scooper.bbox.y1 + scooper.bbox.y2) / 2\n          };\n          const distance = Math.sqrt(\n            Math.pow(handCenter.x - scooperCenter.x, 2) + \n            Math.pow(handCenter.y - scooperCenter.y, 2)\n          );\n          return distance < 100; // Within 100 pixels\n        });\n\n        // Check for movement (indicates handling, not just cleaning)\n        const isHandling = checkHandMovement(handTracking.positions);\n\n        // VIOLATION: Hand in ingredient area without scooper\n        if (nearbyScoopers.length === 0 && isHandling) {\n          const violation = createViolation(\n            'HAND_IN_INGREDIENT_NO_SCOOPER',\n            {\n              handId,\n              hand,\n              zone: currentZone,\n              confidence: hand.confidence,\n              position: handCenter,\n              duration: (currentTime - handTracking.firstDetected) / 1000\n            }\n          );\n          newViolations.push(violation);\n        }\n\n        // VIOLATION: Cross contamination check\n        if (handTracking.lastZone && \n            handTracking.lastZone.id !== currentZone.id && \n            handTracking.lastZone.requiresScooper) {\n          const violation = createViolation(\n            'CROSS_CONTAMINATION',\n            {\n              handId,\n              hand,\n              fromZone: handTracking.lastZone,\n              toZone: currentZone,\n              confidence: hand.confidence * 0.8, // Slightly lower confidence\n              position: handCenter\n            }\n          );\n          newViolations.push(violation);\n        }\n\n        // VIOLATION: Extended contact\n        const contactDuration = (currentTime - handTracking.firstDetected) / 1000;\n        if (contactDuration > 5 && nearbyScoopers.length === 0) { // 5 seconds\n          const violation = createViolation(\n            'EXTENDED_CONTACT',\n            {\n              handId,\n              hand,\n              zone: currentZone,\n              confidence: Math.min(hand.confidence + 0.1, 1.0),\n              position: handCenter,\n              duration: contactDuration\n            }\n          );\n          newViolations.push(violation);\n        }\n\n        handTracking.lastZone = currentZone;\n      }\n    });\n\n    // Clean up old hand tracking data\n    const activeHandIds = hands.map((_, index) => `hand_${index}`);\n    for (const [handId, tracking] of handTrackingRef.current.entries()) {\n      if (!activeHandIds.includes(handId) && \n          currentTime - tracking.positions[tracking.positions.length - 1]?.timestamp > 2000) {\n        handTrackingRef.current.delete(handId);\n      }\n    }\n\n    // Update violations\n    if (newViolations.length > 0) {\n      setViolations(newViolations);\n      setViolationHistory(prev => [...prev, ...newViolations].slice(-50)); // Keep last 50\n      \n      // Notify parent component and show toasts\n      newViolations.forEach(violation => {\n        if (onViolationDetected) {\n          onViolationDetected(violation);\n        }\n        \n        const config = violationTypes[violation.type];\n        toast.error(`${config.icon} ${config.title}`, {\n          position: \"top-center\",\n          autoClose: 5000,\n          hideProgressBar: false,\n          closeOnClick: true,\n          pauseOnHover: true,\n          draggable: true,\n        });\n      });\n    } else {\n      setViolations([]);\n    }\n  };\n\n  const findZoneContainingPoint = (x, y) => {\n    // x, y are detection coordinates (natural frame coordinates)\n    // zones are stored in natural frame coordinates\n    const foundZone = zones.find(zone => {\n      if (zone.points && zone.points.length >= 2) {\n        const [p1, p2] = zone.points;\n        const inZone = x >= Math.min(p1.x, p2.x) && x <= Math.max(p1.x, p2.x) &&\n                      y >= Math.min(p1.y, p2.y) && y <= Math.max(p1.y, p2.y);\n\n        if (inZone) {\n          console.log(`ðŸŽ¯ Point (${x.toFixed(1)}, ${y.toFixed(1)}) is in zone ${zone.name}:`, {\n            point: { x, y },\n            zone: { p1, p2 },\n            zoneName: zone.name\n          });\n        }\n\n        return inZone;\n      }\n      return false;\n    });\n\n    return foundZone;\n  };\n\n  const checkHandMovement = (positions) => {\n    if (positions.length < 2) return false;\n    \n    let totalMovement = 0;\n    for (let i = 1; i < positions.length; i++) {\n      const distance = Math.sqrt(\n        Math.pow(positions[i].x - positions[i-1].x, 2) + \n        Math.pow(positions[i].y - positions[i-1].y, 2)\n      );\n      totalMovement += distance;\n    }\n    \n    return totalMovement > settings.movementThreshold;\n  };\n\n  const createViolation = (type, data) => {\n    return {\n      id: `violation_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      timestamp: new Date().toISOString(),\n      severity: violationTypes[type].severity,\n      confidence: data.confidence,\n      description: violationTypes[type].description,\n      details: data,\n      resolved: false\n    };\n  };\n\n  const drawViolationOverlay = () => {\n    const canvas = violationCanvasRef.current;\n    if (!canvas || violations.length === 0) return;\n\n    const ctx = canvas.getContext('2d');\n\n    // Get the video element to match its display size\n    const videoElement = document.querySelector('img[alt=\"Current frame\"]');\n    if (videoElement) {\n      const rect = videoElement.getBoundingClientRect();\n      canvas.width = rect.width;\n      canvas.height = rect.height;\n      canvas.style.width = rect.width + 'px';\n      canvas.style.height = rect.height + 'px';\n    } else {\n      canvas.width = frameWidth;\n      canvas.height = frameHeight;\n    }\n\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n    // Calculate scaling from natural to display coordinates\n    const naturalWidth = frameWidth;\n    const naturalHeight = frameHeight;\n    const displayWidth = canvas.width;\n    const displayHeight = canvas.height;\n    const scaleX = displayWidth / naturalWidth;\n    const scaleY = displayHeight / naturalHeight;\n\n    console.log('ðŸš¨ Drawing violations:', {\n      violations: violations.length,\n      naturalSize: `${naturalWidth}x${naturalHeight}`,\n      displaySize: `${displayWidth}x${displayHeight}`,\n      scale: `${scaleX.toFixed(3)}x${scaleY.toFixed(3)}`\n    });\n\n    // Draw violation indicators\n    violations.forEach((violation, index) => {\n      const config = violationTypes[violation.type];\n      const position = violation.details.position;\n\n      if (position) {\n        // Scale position from natural to display coordinates\n        const displayX = position.x * scaleX;\n        const displayY = position.y * scaleY;\n\n        // Pulsing violation indicator\n        const pulseScale = 1 + 0.3 * Math.sin(Date.now() / 200);\n        const radius = 30 * pulseScale;\n        \n        // Outer glow\n        ctx.beginPath();\n        ctx.arc(displayX, displayY, radius + 10, 0, 2 * Math.PI);\n        ctx.fillStyle = config.color + '40'; // 25% opacity\n        ctx.fill();\n\n        // Main circle\n        ctx.beginPath();\n        ctx.arc(displayX, displayY, radius, 0, 2 * Math.PI);\n        ctx.fillStyle = config.color + 'AA'; // 67% opacity\n        ctx.fill();\n        ctx.strokeStyle = config.color;\n        ctx.lineWidth = 3;\n        ctx.stroke();\n\n        // Icon\n        ctx.fillStyle = '#FFFFFF';\n        ctx.font = 'bold 20px Arial';\n        ctx.textAlign = 'center';\n        ctx.fillText(config.icon, displayX, displayY + 7);\n\n        // Violation type label\n        ctx.fillStyle = config.color;\n        ctx.font = 'bold 12px Arial';\n        ctx.fillText(violation.type.replace(/_/g, ' '), displayX, displayY - radius - 10);\n\n        console.log(`ðŸš¨ Drew violation at:`, {\n          natural: `(${position.x.toFixed(1)}, ${position.y.toFixed(1)})`,\n          display: `(${displayX.toFixed(1)}, ${displayY.toFixed(1)})`,\n          type: violation.type\n        });\n      }\n    });\n  };\n\n  const getViolationStats = () => {\n    const now = new Date();\n    const last24h = violationHistory.filter(v => {\n      const violationTime = new Date(v.timestamp);\n      const hoursDiff = (now - violationTime) / (1000 * 60 * 60);\n      return hoursDiff < 24;\n    });\n    \n    const byType = {};\n    last24h.forEach(v => {\n      byType[v.type] = (byType[v.type] || 0) + 1;\n    });\n\n    return {\n      total: violationHistory.length,\n      last24h: last24h.length,\n      current: violations.length,\n      byType\n    };\n  };\n\n  const stats = getViolationStats();\n\n  return (\n    <div style={{ width: '100%', position: 'relative' }}>\n      {/* Violation Canvas Overlay - Position it over the video */}\n      <canvas\n        ref={violationCanvasRef}\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          pointerEvents: 'none',\n          zIndex: 30,\n          borderRadius: '8px'\n        }}\n      />\n\n      {/* Violation Controls */}\n      <div style={{ \n        marginTop: '16px', \n        padding: '16px', \n        background: 'rgba(255,255,255,0.1)', \n        borderRadius: '8px' \n      }}>\n        <h4 style={{ margin: '0 0 12px 0', color: '#fff' }}>ðŸš¨ Violation Detection</h4>\n        \n        {/* Settings */}\n        <div style={{ display: 'flex', gap: '16px', marginBottom: '12px', flexWrap: 'wrap' }}>\n          <label style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <input\n              type=\"checkbox\"\n              checked={settings.enabled}\n              onChange={(e) => setSettings({...settings, enabled: e.target.checked})}\n            />\n            <span>Enable Detection</span>\n          </label>\n          \n          <label style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\n            <span>Sensitivity:</span>\n            <input\n              type=\"range\"\n              min=\"0.1\"\n              max=\"1.0\"\n              step=\"0.1\"\n              value={settings.sensitivity}\n              onChange={(e) => setSettings({...settings, sensitivity: parseFloat(e.target.value)})}\n              style={{ width: '100px' }}\n            />\n            <span>{settings.sensitivity}</span>\n          </label>\n        </div>\n\n        {/* Statistics */}\n        <div style={{ \n          display: 'grid', \n          gridTemplateColumns: 'repeat(auto-fit, minmax(120px, 1fr))', \n          gap: '12px',\n          marginBottom: '12px'\n        }}>\n          <div style={{ textAlign: 'center', padding: '8px', background: 'rgba(255,255,255,0.1)', borderRadius: '6px' }}>\n            <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#FF3333' }}>{stats.current}</div>\n            <div style={{ fontSize: '12px', opacity: 0.8 }}>Active Violations</div>\n          </div>\n          <div style={{ textAlign: 'center', padding: '8px', background: 'rgba(255,255,255,0.1)', borderRadius: '6px' }}>\n            <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#FFD23F' }}>{stats.last24h}</div>\n            <div style={{ fontSize: '12px', opacity: 0.8 }}>Last 24 Hours</div>\n          </div>\n          <div style={{ textAlign: 'center', padding: '8px', background: 'rgba(255,255,255,0.1)', borderRadius: '6px' }}>\n            <div style={{ fontSize: '24px', fontWeight: 'bold', color: '#2ED573' }}>{stats.total}</div>\n            <div style={{ fontSize: '12px', opacity: 0.8 }}>Total Detected</div>\n          </div>\n        </div>\n\n        {/* Current Violations */}\n        {violations.length > 0 && (\n          <div style={{ \n            padding: '12px', \n            background: 'rgba(255, 51, 51, 0.2)', \n            borderRadius: '6px',\n            border: '2px solid #FF3333'\n          }}>\n            <h5 style={{ margin: '0 0 8px 0', color: '#FF3333' }}>ðŸš¨ Active Violations</h5>\n            {violations.map((violation, index) => {\n              const config = violationTypes[violation.type];\n              return (\n                <div key={violation.id} style={{ \n                  marginBottom: '8px', \n                  padding: '8px', \n                  background: 'rgba(255,255,255,0.1)', \n                  borderRadius: '4px' \n                }}>\n                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                    <strong style={{ color: config.color }}>\n                      {config.icon} {config.title}\n                    </strong>\n                    <span style={{ \n                      background: config.color, \n                      color: 'white', \n                      padding: '2px 6px', \n                      borderRadius: '4px', \n                      fontSize: '12px' \n                    }}>\n                      {violation.severity.toUpperCase()}\n                    </span>\n                  </div>\n                  <div style={{ fontSize: '14px', opacity: 0.9, marginTop: '4px' }}>\n                    {config.description}\n                  </div>\n                  <div style={{ fontSize: '12px', opacity: 0.7, marginTop: '4px' }}>\n                    Confidence: {(violation.confidence * 100).toFixed(1)}% |\n                    Time: {new Date(violation.timestamp).toLocaleTimeString()}\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default ViolationDetector;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}